<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FeiCoin åŒºå—é“¾æµè§ˆå™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            width: 95%;
            margin: 0 auto;
            background: transparent;
            border-radius: 0;
            box-shadow: none;
            overflow: visible;
        }

        .header {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 15px;
            margin: 20px;
            margin-bottom: 0;
        }

        .header h1 {
            font-size: 1.8em;
            margin-bottom: 6px;
        }

        .header p {
            font-size: 1em;
            opacity: 0.9;
        }

        .main-content {
            padding: 20px;
            display: grid !important;
            grid-template-columns: 1fr 350px !important;
            gap: 20px;
            min-height: calc(100vh - 200px);
            align-items: start;
            width: 100%;
        }
        
        .tab-operations-panel {
            display: flex;
            flex-direction: column;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            min-height: calc(100vh - 200px);
            grid-column: 1;
        }
        
        .logs-panel {
            display: flex !important;
            flex-direction: column;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            position: sticky;
            top: 20px;
            height: calc(100vh - 200px);
            min-height: 500px;
            grid-column: 2;
            width: 350px;
        }

        .section {
            margin-bottom: 25px;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 18px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }
        
        .logs-panel .section {
            margin-bottom: 0;
            border-radius: 0;
            flex: 1;
            display: flex;
            flex-direction: column;
            background: transparent;
            box-shadow: none;
        }

        .section h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.5em;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 8px;
        }


        .transfer-form {
            background: white;
            padding: 15px;
            border-radius: 6px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }

        .form-group {
            margin-bottom: 12px;
        }
        
        .form-row {
            display: flex;
            margin-bottom: 12px;
        }
        
        .form-row .form-group {
            margin-bottom: 0;
        }

        .form-group label {
            display: block;
            margin-bottom: 4px;
            font-weight: 600;
            color: #333;
            font-size: 0.9em;
        }

        .form-group select,
        .form-group input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }

        .btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-right: 8px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .logs {
            background: #1e1e1e;
            color: #00ff00;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            flex: 1;
            overflow-y: auto;
            border: 2px solid #333;
            min-height: 300px;
        }

        .log-entry {
            margin-bottom: 5px;
            padding: 5px 0;
            border-bottom: 1px solid #333;
        }

        .log-timestamp {
            color: #888;
            margin-right: 10px;
        }

        .log-level-info { color: #00ff00; }
        .log-level-error { color: #ff0000; }
        .log-level-warning { color: #ffff00; }
        .log-level-transfer { color: #00bfff; }
        .log-level-success { color: #32cd32; }
        
        .transfer-separator {
            border: none;
            border-top: 2px solid #444;
            margin: 15px 0;
            background: linear-gradient(90deg, transparent 0%, #00bfff 20%, #00bfff 80%, transparent 100%);
            height: 2px;
            position: relative;
        }
        
        .transfer-separator::before {
            content: 'ğŸ’¸ è½¬è´¦æµç¨‹ ğŸ’¸';
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background: #1e1e1e;
            color: #00bfff;
            padding: 0 10px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .transfer-end-separator {
            border: none;
            border-top: 2px solid #444;
            margin: 15px 0;
            background: linear-gradient(90deg, transparent 0%, #32cd32 20%, #32cd32 80%, transparent 100%);
            height: 2px;
            position: relative;
        }
        
        .transfer-end-separator::before {
            content: 'âœ… è½¬è´¦å®Œæˆ âœ…';
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background: #1e1e1e;
            color: #32cd32;
            padding: 0 10px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .transfer-log {
            background: rgba(0, 191, 255, 0.1);
            border-left: 3px solid #00bfff;
            padding-left: 10px;
            margin: 2px 0;
        }
        
        .success-log {
            background: rgba(50, 205, 50, 0.15);
            border-left: 3px solid #32cd32;
            padding-left: 10px;
            margin: 2px 0;
        }

        .status {
            padding: 10px 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: 600;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status.loading {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .blockchain-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-top: 15px;
        }

        .info-card {
            background: white;
            padding: 12px;
            border-radius: 6px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            text-align: center;
            border-top: 3px solid #4CAF50;
        }

        .info-card h4 {
            color: #666;
            font-size: 0.8em;
            margin-bottom: 6px;
            text-transform: uppercase;
        }

        .info-card .value {
            font-size: 1.2em;
            font-weight: bold;
            color: #4CAF50;
        }

        /* é’±åŒ…ç®¡ç†æ ·å¼ */
        .wallet-management,
        .validator-management {
            margin-top: 20px;
        }
        
        .wallet-actions,
        .validator-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .wallet-form,
        .validator-form {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            margin: 20px 0;
            border-left: 4px solid #2196F3;
        }
        
        .wallet-form h3,
        .validator-form h3 {
            color: #2196F3;
            margin-bottom: 15px;
        }
        
        .wallet-form textarea,
        .validator-form textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            font-family: monospace;
            resize: vertical;
        }
        
        .wallet-list,
        .validator-list {
            margin-top: 20px;
        }
        
        .wallet-item,
        .validator-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin: 10px 0;
            border-left: 4px solid #4CAF50;
        }
        
        .wallet-item h4,
        .validator-item h4 {
            color: #4CAF50;
            margin-bottom: 10px;
        }
        
        .wallet-address,
        .validator-address {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: #666;
            background: #f5f5f5;
            padding: 5px 8px;
            border-radius: 4px;
            margin: 5px 0;
            word-break: break-all;
        }
        
        .wallet-balance {
            margin: 8px 0;
            padding: 8px 12px;
            background: #e8f5e8;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
        }
        
        .validator-status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .validator-status.bonded {
            background: #d4edda;
            color: #155724;
        }
        
        .validator-status.unbonded {
            background: #f8d7da;
            color: #721c24;
        }
        
        .validator-tokens {
            font-weight: bold;
            color: #2196F3;
        }
        
        .mnemonic-display {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            word-break: break-all;
        }
        
        .mnemonic-warning {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 6px;
            padding: 10px;
            margin: 10px 0;
            color: #721c24;
            font-weight: bold;
        }
        
        /* é’±åŒ…ç®€ä»‹æ¨¡å¼æ ·å¼ */
        .wallet-item-compact {
            background: white;
            padding: 8px 12px;
            border-radius: 6px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            margin: 6px;
            border-left: 3px solid #4CAF50;
            display: block;
            min-width: 180px;
            flex: 1;
        }
        
        .wallets-container-horizontal {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }
        
        .wallet-compact-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .wallet-compact-info {
            flex: 1;
        }
        
        .wallet-compact-name {
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 2px;
            font-size: 0.9em;
        }
        
        .wallet-compact-balance {
            font-size: 0.8em;
            color: #666;
            font-family: 'Courier New', monospace;
            margin-bottom: 4px;
        }
        
        .wallet-compact-actions {
            display: flex;
            gap: 4px;
            align-items: center;
            flex-shrink: 0;
        }
        
        .wallet-compact-actions-mini {
            display: flex;
            gap: 4px;
            justify-content: center;
            margin-top: 6px;
        }
        
        .btn-small {
            padding: 4px 8px;
            font-size: 0.75em;
            border-radius: 3px;
        }
        
        .btn-mini {
            padding: 3px 6px;
            font-size: 0.7em;
            border-radius: 3px;
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .btn-mini:hover {
            transform: scale(1.05);
        }
        
        .wallet-details {
            margin-top: 12px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 6px;
            border: 1px solid #e9ecef;
            display: none;
        }
        
        .wallet-details.expanded {
            display: block;
        }
        
        .wallet-details .wallet-address {
            font-family: 'Courier New', monospace;
            font-size: 11px;
            color: #666;
            background: #fff;
            padding: 8px;
            border-radius: 4px;
            margin: 8px 0;
            word-break: break-all;
            border: 1px solid #ddd;
        }
        
        .expand-btn {
            background: none;
            border: none;
            color: #007bff;
            cursor: pointer;
            font-size: 0.85em;
            text-decoration: underline;
            padding: 2px 4px;
            white-space: nowrap;
        }
        
        .expand-btn:hover {
            color: #0056b3;
        }
        
        /* å¥–åŠ±ç®¡ç†æ ·å¼ */
        .rewards-management {
            margin-top: 20px;
        }
        
        .rewards-container {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin: 15px 0;
            border-left: 4px solid #FF9800;
        }
        
        .rewards-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .rewards-header h3 {
            color: #FF9800;
            margin: 0;
            font-size: 1.1em;
        }
        
        .reward-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #fff3e0;
            border-radius: 6px;
            margin: 8px 0;
            border: 1px solid #ffcc02;
        }
        
        .reward-info {
            flex: 1;
        }
        
        .reward-amount {
            font-weight: bold;
            color: #FF9800;
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
        }
        
        .reward-validator {
            font-size: 0.9em;
            color: #666;
            margin-top: 4px;
        }
        
        .reward-actions {
            display: flex;
            gap: 8px;
        }
        
        .btn-reward {
            background: linear-gradient(45deg, #FF9800, #F57C00);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-reward:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255, 152, 0, 0.3);
        }
        
        .btn-reward:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .total-rewards {
            background: #e8f5e8;
            padding: 12px;
            border-radius: 6px;
            border: 2px solid #4CAF50;
            text-align: center;
            margin: 10px 0;
        }
        
        .total-rewards .amount {
            font-size: 1.3em;
            font-weight: bold;
            color: #4CAF50;
            font-family: 'Courier New', monospace;
        }
        
        /* Tokenåˆ†å¸ƒè¡¨æ ·å¼ */
        .token-distribution-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        .token-distribution-table th,
        .token-distribution-table td {
            padding: 8px 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .token-distribution-table th {
            background: #f8f9fa;
            font-weight: bold;
            color: #333;
        }
        
        .token-distribution-table .address-cell {
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            max-width: 150px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .token-distribution-table .amount-cell {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: #4CAF50;
        }
        
        .token-distribution-table .percentage-cell {
            color: #666;
            font-size: 0.9em;
        }
        
        .token-distribution-table tr:hover {
            background: #f5f5f5;
        }
        
        /* Tabé¡µé¢æ ·å¼ */
        .tab-container {
            width: 100%;
            margin: 0;
            height: 100%;
            display: flex;
            flex-direction: column;
            flex: 1;
        }
        
        .tab-header {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #ddd;
            overflow-x: auto;
            white-space: nowrap;
            flex-shrink: 0;
        }
        
        .tab-button {
            padding: 15px 25px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            white-space: nowrap;
            flex-shrink: 0;
        }
        
        .tab-button:hover {
            background: #e9ecef;
            color: #333;
        }
        
        .tab-button.active {
            color: #4CAF50;
            border-bottom-color: #4CAF50;
            background: white;
        }
        
        .tab-content {
            background: white;
            padding: 0;
            border-radius: 0 0 8px 8px;
            flex: 1;
            overflow-y: auto;
            max-height: calc(100vh - 200px);
        }
        
        .tab-panel {
            display: none;
            padding: 20px;
            animation: fadeIn 0.3s ease-in;
        }
        
        .tab-panel.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* å“åº”å¼Tab */
        @media (max-width: 768px) {
            .tab-button {
                padding: 12px 15px;
                font-size: 0.9em;
            }
            
            .tab-header {
                border-radius: 0;
            }
        }
        
        
        /* Tokenå¢å‘è¡¨å•æ ·å¼ */
        .mint-form-divider {
            margin: 15px 0;
            padding: 8px 0;
            border-top: 1px dashed #ddd;
            color: #666;
            font-size: 0.9em;
            text-align: center;
        }
        
        .form-group.custom-input {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 6px;
            border: 1px dashed #ccc;
        }
        
        .form-group.custom-input label {
            color: #666;
            font-style: italic;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
            }
            
            .main-content {
                padding: 10px;
                grid-template-columns: 1fr !important;
                grid-template-rows: 1fr auto;
                gap: 10px;
            }
            
            .container {
                width: 100%;
                margin: 0;
            }
            
            .logs-panel {
                position: relative;
                top: 0;
                max-height: 300px;
            }
            
            .tab-content {
                max-height: 60vh;
            }
            
            .tab-operations-panel,
            .logs-panel {
                min-height: auto;
            }
            
            .wallet-actions,
            .validator-actions {
                flex-direction: column;
            }
            
            .tab-button {
                padding: 12px 15px;
                font-size: 0.9em;
            }
            
            .tab-header {
                border-radius: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ FeiCoin åŒºå—é“¾æµè§ˆå™¨</h1>
            <p>çœŸå®åŒºå—é“¾æµè§ˆå™¨ - è¿æ¥ FeiCoin ç½‘ç»œï¼Œæ‰§è¡ŒçœŸå®è½¬è´¦äº¤æ˜“</p>
        </div>

        <div class="main-content">
            <!-- å·¦ä¾§ï¼šTabé¡µé¢å®¹å™¨ -->
            <div class="tab-operations-panel">
                <div class="tab-container">
                    <!-- Tab å¤´éƒ¨ -->
                    <div class="tab-header">
                        <button class="tab-button active" onclick="switchTab('blockchain')">â›“ï¸ åŒºå—é“¾çŠ¶æ€</button>
                        <button class="tab-button" onclick="switchTab('token')">ğŸª™ Tokenç®¡ç†</button>
                        <button class="tab-button" onclick="switchTab('wallet')">ğŸ’¸ è½¬è´¦&é’±åŒ…</button>
                        <button class="tab-button" onclick="switchTab('validator')">ğŸ›ï¸ éªŒè¯è€…&è´¨æŠ¼</button>
                    </div>
                
                <!-- Tab å†…å®¹ -->
                <div class="tab-content">
                    <!-- åŒºå—é“¾çŠ¶æ€é¡µ -->
                    <div class="tab-panel active" id="tab-blockchain">
                        <div class="section">
                            <h2>â›“ï¸ åŒºå—é“¾çŠ¶æ€</h2>
                            
                            <!-- åŸºç¡€ç½‘ç»œä¿¡æ¯ -->
                            <div style="margin-bottom: 20px;">
                                <h3 style="color: #4CAF50; margin-bottom: 10px;">ğŸŒ ç½‘ç»œåŸºç¡€ä¿¡æ¯</h3>
                                <div class="blockchain-info">
                                    <div class="info-card">
                                        <h4>å½“å‰é«˜åº¦</h4>
                                        <div class="value" id="block-height">-</div>
                                    </div>
                                    <div class="info-card">
                                        <h4>ç½‘ç»œID</h4>
                                        <div class="value" id="chain-id">-</div>
                                    </div>
                                    <div class="info-card">
                                        <h4>æœ€æ–°åŒºå—æ—¶é—´</h4>
                                        <div class="value" id="block-time" style="font-size: 0.9em;">-</div>
                                    </div>
                                    <div class="info-card">
                                        <h4>åŒºå—é—´éš”</h4>
                                        <div class="value" id="block-interval">-</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- éªŒè¯è€…ä¸è´¨æŠ¼ä¿¡æ¯ -->
                            <div style="margin-bottom: 20px;">
                                <h3 style="color: #4CAF50; margin-bottom: 10px;">ğŸ›ï¸ éªŒè¯è€…ä¸è´¨æŠ¼</h3>
                                <div class="blockchain-info">
                                    <div class="info-card">
                                        <h4>éªŒè¯è€…æ•°é‡</h4>
                                        <div class="value" id="validator-count">-</div>
                                    </div>
                                    <div class="info-card">
                                        <h4>æ´»è·ƒéªŒè¯è€…</h4>
                                        <div class="value" id="active-validators">-</div>
                                    </div>
                                    <div class="info-card">
                                        <h4>æ€»è´¨æŠ¼é‡</h4>
                                        <div class="value" id="total-bonded">-</div>
                                    </div>
                                    <div class="info-card">
                                        <h4>è´¨æŠ¼ç‡</h4>
                                        <div class="value" id="bonded-ratio">-</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ç½‘ç»œæ²»ç†ä¿¡æ¯ -->
                            <div style="margin-bottom: 20px;">
                                <h3 style="color: #4CAF50; margin-bottom: 10px;">ğŸ—³ï¸ æ²»ç†ä¿¡æ¯</h3>
                                <div class="blockchain-info">
                                    <div class="info-card">
                                        <h4>ææ¡ˆæ€»æ•°</h4>
                                        <div class="value" id="total-proposals">-</div>
                                    </div>
                                    <div class="info-card">
                                        <h4>æ´»è·ƒææ¡ˆ</h4>
                                        <div class="value" id="active-proposals">-</div>
                                    </div>
                                    <div class="info-card">
                                        <h4>ç¤¾åŒºæ± </h4>
                                        <div class="value" id="community-pool">-</div>
                                    </div>
                                    <div class="info-card">
                                        <h4>é€šèƒ€ç‡</h4>
                                        <div class="value" id="inflation-rate">-</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- æœ€æ–°åŒºå—è¯¦æƒ… -->
                            <div style="margin-bottom: 20px;">
                                <h3 style="color: #4CAF50; margin-bottom: 10px;">ğŸ“¦ æœ€æ–°åŒºå—è¯¦æƒ…</h3>
                                <div class="blockchain-info">
                                    <div class="info-card">
                                        <h4>åŒºå—å“ˆå¸Œ</h4>
                                        <div class="value" id="block-hash" style="font-size: 0.8em; font-family: monospace;">-</div>
                                    </div>
                                    <div class="info-card">
                                        <h4>äº¤æ˜“æ•°é‡</h4>
                                        <div class="value" id="tx-count">-</div>
                                    </div>
                                    <div class="info-card">
                                        <h4>åŒºå—å¤§å°</h4>
                                        <div class="value" id="block-size">-</div>
                                    </div>
                                    <div class="info-card">
                                        <h4>å‡ºå—éªŒè¯è€…</h4>
                                        <div class="value" id="proposer" style="font-size: 0.9em;">-</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- å®æ—¶æ•°æ®åˆ·æ–°æŒ‰é’® -->
                            <div style="text-align: center; margin-top: 20px;">
                                <button class="btn" onclick="refreshAllBlockchainData()" id="refresh-blockchain-btn">ğŸ”„ åˆ·æ–°æ‰€æœ‰æ•°æ®</button>
                                <button class="btn" onclick="toggleRealTimeUpdate()" id="realtime-btn" style="background: #17a2b8;">âš¡ å®æ—¶æ›´æ–°: å¼€å¯</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tokenç®¡ç†é¡µ -->
                    <div class="tab-panel" id="tab-token">
                        <div class="section">
                            <h2>ğŸª™ Token ç®¡ç†</h2>
                            
                            <!-- Tokenç»Ÿè®¡ -->
                            <div style="margin-bottom: 20px; background: #e8f5e8; padding: 15px; border-radius: 8px;">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                    <div class="info-card">
                                        <h4>Tokenæ€»ä¾›åº”é‡</h4>
                                        <div class="value" id="token-total-supply">åŠ è½½ä¸­...</div>
                                    </div>
                                    <div class="info-card">
                                        <h4>Tokenæµé€šé‡</h4>
                                        <div class="value" id="token-circulation">åŠ è½½ä¸­...</div>
                                    </div>
                                    <div class="info-card">
                                        <h4>æŒæœ‰åœ°å€æ•°</h4>
                                        <div class="value" id="token-holders">åŠ è½½ä¸­...</div>
                                    </div>
                                </div>
                                <div style="margin-top: 15px; text-align: center;">
                                    <button class="btn" onclick="showMintTokenForm()">ğŸ”¨ æ¨¡æ‹Ÿå¢å‘ (è½¬è´¦)</button>
                                    <button class="btn" onclick="showRealMintInfo()" style="background: #6c757d;" disabled title="FeiCoinä¸æ”¯æŒçœŸå®å¢å‘">ğŸ’ çœŸå®å¢å‘ (ä¸æ”¯æŒ)</button>
                                    <button class="btn" onclick="showRealMintInfo()" style="background: #17a2b8;">â„¹ï¸ æŠ€æœ¯è¯´æ˜</button>
                                    <button class="btn" onclick="refreshTokenStats()">ğŸ”„ åˆ·æ–°ç»Ÿè®¡</button>
                                    <button class="btn" onclick="showTokenDistribution()">ğŸ“Š æŸ¥çœ‹åˆ†å¸ƒ</button>
                                </div>
                            </div>
                            
                            <!-- Tokenå¢å‘è¡¨å• -->
                            <div id="mint-token-form" class="wallet-form" style="display: none; border-left: 4px solid #FF9800;">
                                <h3>ğŸ”¨ æ¨¡æ‹Ÿå¢å‘Token (ç®¡ç†å‘˜è½¬è´¦)</h3>
                                <div style="background: #fff3cd; padding: 8px; border-radius: 4px; margin-bottom: 15px; font-size: 0.9em; color: #856404;">
                                    âš ï¸ æ³¨æ„ï¼šè¿™æ˜¯æ¨¡æ‹Ÿå¢å‘åŠŸèƒ½ï¼Œå®é™…æ˜¯ä»ç®¡ç†å‘˜è´¦æˆ·è½¬è´¦åˆ°æ¥æ”¶åœ°å€ã€‚çœŸæ­£çš„å¢å‘éœ€è¦åŒºå—é“¾æ¨¡å—çº§åˆ«çš„mintæƒé™ã€‚
                                </div>
                                <div class="form-group">
                                    <label for="mint-from-account">ç®¡ç†å‘˜è´¦æˆ·:</label>
                                    <select id="mint-from-account">
                                        <option value="">é€‰æ‹©è´¦æˆ·</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="mint-to-account">æ¥æ”¶åœ°å€:</label>
                                    <select id="mint-to-account">
                                        <option value="">é€‰æ‹©æ¥æ”¶è´¦æˆ·</option>
                                    </select>
                                </div>
                                <div class="mint-form-divider">æˆ–</div>
                                <div class="form-group custom-input">
                                    <label for="mint-to-custom">è‡ªå®šä¹‰æ¥æ”¶åœ°å€:</label>
                                    <input type="text" id="mint-to-custom" placeholder="è¾“å…¥æ¥æ”¶åœ°å€ (feic1...)">
                                </div>
                                <div class="form-group">
                                    <label for="mint-amount">å¢å‘æ•°é‡:</label>
                                    <input type="number" id="mint-amount" placeholder="è¾“å…¥å¢å‘æ•°é‡" min="1">
                                </div>
                                <div class="form-group">
                                    <label for="mint-denom">ä»£å¸ç±»å‹:</label>
                                    <select id="mint-denom">
                                        <option value="token">token</option>
                                        <option value="stake">stake</option>
                                    </select>
                                </div>
                                <button class="btn" id="mint-btn" onclick="mintTokens()" style="background: linear-gradient(45deg, #FF9800, #F57C00);">ğŸ”¨ æ‰§è¡Œå¢å‘</button>
                                <button class="btn" onclick="hideMintTokenForm()">âŒ å–æ¶ˆ</button>
                                <div id="mint-status"></div>
                            </div>
                            
                            <!-- Tokenåˆ†å¸ƒè¡¨ -->
                            <div id="token-distribution-section" class="wallet-form" style="display: none; border-left: 4px solid #2196F3;">
                                <h3>ğŸ“Š Token åˆ†å¸ƒç»Ÿè®¡</h3>
                                <div style="margin-bottom: 15px;">
                                    <select id="distribution-token-type" onchange="refreshTokenDistribution()">
                                        <option value="token">Token</option>
                                        <option value="stake">Stake</option>
                                    </select>
                                    <button class="btn-mini" onclick="refreshTokenDistribution()">ğŸ”„</button>
                                </div>
                                <div id="token-distribution-list">
                                    åŠ è½½ä¸­...
                                </div>
                                <button class="btn" onclick="hideTokenDistribution()">âŒ å…³é—­</button>
                            </div>
                            
                            <!-- çœŸå®å¢å‘è¯´æ˜ -->
                            <div id="real-mint-info" class="wallet-form" style="display: none; border-left: 4px solid #17a2b8;">
                                <h3>â„¹ï¸ çœŸå®Tokenå¢å‘è¯´æ˜</h3>
                                <div style="line-height: 1.6; color: #333;">
                                    <h4>ğŸ” çœŸå®å¢å‘éœ€è¦çš„æ¡ä»¶ï¼š</h4>
                                    <ul style="margin: 10px 0; padding-left: 20px;">
                                        <li><strong>æ¨¡å—æƒé™</strong>ï¼šéœ€è¦bankæ¨¡å—çš„mintæƒé™</li>
                                        <li><strong>æ²»ç†ææ¡ˆ</strong>ï¼šé€šè¿‡é“¾ä¸Šæ²»ç†æŠ•ç¥¨å†³å®š</li>
                                        <li><strong>å¤šé‡ç­¾å</strong>ï¼šå¤šä¸ªéªŒè¯è€…å…±åŒç­¾ç½²</li>
                                        <li><strong>é¢„è®¾è§„åˆ™</strong>ï¼šæŒ‰ç…§é¢„å®šçš„é€šèƒ€æœºåˆ¶</li>
                                    </ul>
                                    
                                    <h4>ğŸ’¡ çœŸå®å¢å‘çš„å‘½ä»¤ç¤ºä¾‹ï¼š</h4>
                                    <div style="background: #f8f9fa; padding: 10px; border-radius: 4px; font-family: monospace; margin: 10px 0;">
                                        # å¦‚æœæœ‰mintæƒé™ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š<br>
                                        feicoind tx bank mint [åœ°å€] [æ•°é‡][ä»£å¸] --from [ç®¡ç†å‘˜] --chain-id feicoin
                                    </div>
                                    
                                    <h4>âŒ å½“å‰FeiCoiné™åˆ¶ï¼š</h4>
                                    <div style="background: #f8d7da; padding: 10px; border-radius: 4px; margin: 10px 0; border: 1px solid #f5c6cb;">
                                        <strong>ç»è¿‡æµ‹è¯•ç¡®è®¤ï¼ŒFeiCoinä¸æ”¯æŒçœŸå®Tokenå¢å‘ï¼š</strong>
                                        <ul style="margin: 5px 0; padding-left: 20px;">
                                            <li><span style="color: #721c24;">âœ—</span> ä¸æ”¯æŒæ ‡å‡†çš„ <code>/cosmos.bank.v1beta1.MsgMint</code> æ¶ˆæ¯</li>
                                            <li><span style="color: #721c24;">âœ—</span> æ²»ç†ææ¡ˆæ— æ³•æ‰§è¡Œmintæ“ä½œ</li>
                                            <li><span style="color: #721c24;">âœ—</span> æ²¡æœ‰è‡ªå®šä¹‰çš„å¢å‘æ¨¡å—</li>
                                            <li><span style="color: #155724;">âœ“</span> åªèƒ½é€šè¿‡è½¬è´¦æ¨¡æ‹Ÿå¢å‘ï¼ˆæ¨èï¼‰</li>
                                        </ul>
                                        <div style="margin-top: 8px; padding: 8px; background: #d1ecf1; border: 1px solid #bee5eb; border-radius: 4px;">
                                            <strong>æ¨èæ–¹æ¡ˆï¼š</strong>ä½¿ç”¨"æ¨¡æ‹Ÿå¢å‘"åŠŸèƒ½ï¼Œå®ƒå®é™…è°ƒç”¨åŒºå—é“¾è½¬è´¦å‘½ä»¤ï¼Œæ•ˆæœç­‰åŒäºä»å‚¨å¤‡è´¦æˆ·åˆ†å‘ä»£å¸ã€‚
                                        </div>
                                    </div>
                                    
                                    <h4>ğŸ”§ å¦‚ä½•å¼€å¯çœŸå®å¢å‘ï¼š</h4>
                                    <ol style="margin: 10px 0; padding-left: 20px;">
                                        <li>ä¿®æ”¹åˆ›ä¸–æ–‡ä»¶é…ç½®bankæ¨¡å—æƒé™</li>
                                        <li>åˆ›å»ºè‡ªå®šä¹‰æ¨¡å—å¤„ç†å¢å‘é€»è¾‘</li>
                                        <li>é€šè¿‡æ²»ç†ææ¡ˆæˆæƒç‰¹å®šåœ°å€</li>
                                        <li>ä½¿ç”¨å¤šé‡ç­¾åä¿éšœå®‰å…¨æ€§</li>
                                    </ol>
                                </div>
                                <button class="btn" onclick="hideRealMintInfo()">âŒ å…³é—­</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- è½¬è´¦&é’±åŒ…ç®¡ç†é¡µ -->
                    <div class="tab-panel" id="tab-wallet">
                        <div class="section">
                            <h2>ğŸ’¸ è½¬è´¦ & é’±åŒ…ç®¡ç†</h2>
                            
                            <!-- é’±åŒ…ä½™é¢æ˜¾ç¤º -->
                            <div style="margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <h3 style="font-size: 1.1em; margin: 0; color: #333;">ğŸ’° è´¦æˆ·ä½™é¢</h3>
                                    <div>
                                        <button class="btn-mini" onclick="refreshWalletList()">ğŸ”„</button>
                                        <button class="btn-mini" onclick="showCreateWallet()">+</button>
                                        <button class="btn-mini" onclick="showImportWallet()">ğŸ“¥</button>
                                    </div>
                                </div>
                                <div class="wallets-container-horizontal" id="wallets-container">
                                    åŠ è½½ä¸­...
                                </div>
                            </div>
                            
                            <!-- è½¬è´¦è¡¨å• -->
                            <div class="transfer-form">
                                <div class="form-row">
                                    <div class="form-group" style="flex: 1; margin-right: 10px;">
                                        <label for="from-account">ä»è´¦æˆ·:</label>
                                        <select id="from-account">
                                            <option value="alice">Alice (feic1kpyhmumrt5g0veex9lhpzh3m99rptmmuz7cq8u)</option>
                                            <option value="bob">Bob (feic1kfde52eamxnnwkn2yjv9uj5xuf0amxuh70tnpw)</option>
                                        </select>
                                    </div>
                                    <div class="form-group" style="flex: 1;">
                                        <label for="to-account">åˆ°è´¦æˆ·:</label>
                                        <select id="to-account">
                                            <option value="bob">Bob (feic1kfde52eamxnnwkn2yjv9uj5xuf0amxuh70tnpw)</option>
                                            <option value="alice">Alice (feic1kpyhmumrt5g0veex9lhpzh3m99rptmmuz7cq8u)</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group" style="flex: 2; margin-right: 10px;">
                                        <label for="amount">è½¬è´¦é‡‘é¢:</label>
                                        <input type="number" id="amount" placeholder="è¾“å…¥è½¬è´¦é‡‘é¢" min="1">
                                    </div>
                                    <div class="form-group" style="flex: 1;">
                                        <label for="denom">ä»£å¸ç±»å‹:</label>
                                        <select id="denom">
                                            <option value="token">token</option>
                                            <option value="stake">stake</option>
                                        </select>
                                    </div>
                                </div>
                                <button class="btn" onclick="sendTransfer()" id="transfer-btn">ğŸ’³ å‘èµ·è½¬è´¦</button>
                            </div>
                            <div id="transfer-status"></div>
                            
                            <!-- é’±åŒ…åˆ›å»º/å¯¼å…¥è¡¨å• -->
                            <div id="create-wallet-form" class="wallet-form" style="display: none;">
                                <h3>åˆ›å»ºæ–°é’±åŒ…</h3>
                                <div class="form-group">
                                    <label for="new-wallet-name">é’±åŒ…åç§°:</label>
                                    <input type="text" id="new-wallet-name" placeholder="è¾“å…¥é’±åŒ…åç§°">
                                </div>
                                <button class="btn" onclick="createWallet()">ğŸ”‘ åˆ›å»ºé’±åŒ…</button>
                                <button class="btn" onclick="hideWalletForms()">âŒ å–æ¶ˆ</button>
                            </div>
                            
                            <div id="import-wallet-form" class="wallet-form" style="display: none;">
                                <h3>å¯¼å…¥é’±åŒ…</h3>
                                <div class="form-group">
                                    <label for="import-wallet-name">é’±åŒ…åç§°:</label>
                                    <input type="text" id="import-wallet-name" placeholder="è¾“å…¥é’±åŒ…åç§°">
                                </div>
                                <div class="form-group">
                                    <label for="wallet-mnemonic">åŠ©è®°è¯:</label>
                                    <textarea id="wallet-mnemonic" placeholder="è¾“å…¥12æˆ–24ä¸ªåŠ©è®°è¯ï¼Œç”¨ç©ºæ ¼åˆ†éš”" rows="3"></textarea>
                                </div>
                                <button class="btn" onclick="importWallet()">ğŸ“¥ å¯¼å…¥é’±åŒ…</button>
                                <button class="btn" onclick="hideWalletForms()">âŒ å–æ¶ˆ</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- éªŒè¯è€…&è´¨æŠ¼ç®¡ç†é¡µ -->
                    <div class="tab-panel" id="tab-validator">
                        <div class="section">
                            <h2>ğŸ›ï¸ éªŒè¯è€… & è´¨æŠ¼ç®¡ç†</h2>
                            <div class="validator-management">
                                <div class="validator-actions">
                                    <button class="btn" onclick="refreshValidatorList()">ğŸ”„ åˆ·æ–°éªŒè¯è€…</button>
                                    <button class="btn" onclick="showCreateValidator()">â• åˆ›å»ºéªŒè¯è€…</button>
                                    <button class="btn" onclick="showDelegateForm()">ğŸ¤ å§”æ‰˜è´¨æŠ¼</button>
                                </div>
                                
                                <!-- åˆ›å»ºéªŒè¯è€…è¡¨å• -->
                                <div id="create-validator-form" class="validator-form" style="display: none;">
                                    <h3>åˆ›å»ºéªŒè¯è€…</h3>
                                    <div class="form-group">
                                        <label for="validator-account">è´¦æˆ·:</label>
                                        <select id="validator-account">
                                            <option value="">é€‰æ‹©è´¦æˆ·</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="validator-amount">è´¨æŠ¼é‡‘é¢:</label>
                                        <input type="number" id="validator-amount" placeholder="è´¨æŠ¼é‡‘é¢" min="1000000">
                                    </div>
                                    <div class="form-group">
                                        <label for="validator-moniker">éªŒè¯è€…åç§°:</label>
                                        <input type="text" id="validator-moniker" placeholder="éªŒè¯è€…æ˜¾ç¤ºåç§°">
                                    </div>
                                    <div class="form-group">
                                        <label for="validator-commission">ä½£é‡‘ç‡ (%):</label>
                                        <input type="number" id="validator-commission" placeholder="10" min="0" max="100" step="0.01">
                                    </div>
                                    <button class="btn" onclick="createValidator()">âš¡ åˆ›å»ºéªŒè¯è€…</button>
                                    <button class="btn" onclick="hideValidatorForms()">âŒ å–æ¶ˆ</button>
                                </div>
                                
                                <!-- å§”æ‰˜è¡¨å• -->
                                <div id="delegate-form" class="validator-form" style="display: none;">
                                    <h3>å§”æ‰˜è´¨æŠ¼</h3>
                                    <div class="form-group">
                                        <label for="delegate-account">è´¦æˆ·:</label>
                                        <select id="delegate-account">
                                            <option value="">é€‰æ‹©è´¦æˆ·</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="delegate-validator">éªŒè¯è€…:</label>
                                        <select id="delegate-validator">
                                            <option value="">é€‰æ‹©éªŒè¯è€…</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="delegate-amount">å§”æ‰˜é‡‘é¢:</label>
                                        <input type="number" id="delegate-amount" placeholder="å§”æ‰˜é‡‘é¢" min="1">
                                    </div>
                                    <button class="btn" onclick="delegateStake()">ğŸ¤ å§”æ‰˜è´¨æŠ¼</button>
                                    <button class="btn" onclick="hideValidatorForms()">âŒ å–æ¶ˆ</button>
                                </div>
                                
                                <!-- éªŒè¯è€…åˆ—è¡¨ -->
                                <div class="validator-list" id="validator-list">
                                    <h3>éªŒè¯è€…åˆ—è¡¨</h3>
                                    <div id="validators-container">åŠ è½½ä¸­...</div>
                                </div>
                                
                                <!-- å¥–åŠ±ç®¡ç† -->
                                <div class="rewards-management">
                                    <div class="rewards-container">
                                        <div class="rewards-header">
                                            <h3>ğŸ† å¥–åŠ±ç®¡ç†</h3>
                                            <button class="btn-mini" onclick="refreshRewards()" title="åˆ·æ–°å¥–åŠ±">ğŸ”„</button>
                                        </div>
                                        
                                        <!-- æ€»å¥–åŠ±ç»Ÿè®¡ -->
                                        <div class="total-rewards" id="total-rewards">
                                            <div>æ€»è®¡æœªæå–å¥–åŠ±</div>
                                            <div class="amount" id="total-reward-amount">åŠ è½½ä¸­...</div>
                                        </div>
                                        
                                        <!-- å¥–åŠ±è¯¦æƒ…åˆ—è¡¨ -->
                                        <div id="rewards-list">
                                            åŠ è½½ä¸­...
                                        </div>
                                        
                                        <!-- æ‰¹é‡æ“ä½œ -->
                                        <div style="text-align: center; margin-top: 15px;">
                                            <button class="btn-reward" onclick="withdrawAllRewards()" id="withdraw-all-btn">
                                                ğŸ’° æå–æ‰€æœ‰å¥–åŠ±
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div>

            <!-- å³ä¾§ï¼šæ—¥å¿—é¢æ¿ -->
            <div class="logs-panel">
                <div class="section">
                    <h2>ğŸ“‹ åŒºå—é“¾æ‰§è¡Œæ—¥å¿—</h2>
                    <div style="margin-bottom: 15px;">
                        <button class="btn" onclick="clearLogs()">ğŸ—‘ï¸ æ¸…é™¤æ—¥å¿—</button>
                        <button class="btn" onclick="toggleAutoRefresh()">
                            <span id="auto-refresh-text">â¸ï¸ åœæ­¢è‡ªåŠ¨åˆ·æ–°</span>
                        </button>
                    </div>
                    <div class="logs" id="blockchain-logs">
                        <div class="log-entry">
                            <span class="log-timestamp">[ç³»ç»Ÿå¯åŠ¨]</span>
                            <span class="log-level-info">[INFO]</span> ğŸ¯ åŒºå—é“¾æµè§ˆå™¨å·²åŠ è½½ï¼Œç­‰å¾…è¿æ¥åŒºå—é“¾ç½‘ç»œ...
                        </div>
                        <div class="log-entry" style="color: #666; font-style: italic;">
                            <span class="log-timestamp">[ä½¿ç”¨æç¤º]</span>
                            ğŸ’¡ è½¬è´¦æ—¥å¿—å°†ä»¥è“è‰²é«˜äº®æ˜¾ç¤ºï¼ŒæˆåŠŸæ“ä½œä»¥ç»¿è‰²æ˜¾ç¤º
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // è´¦æˆ·åœ°å€æ˜ å°„ (åŠ¨æ€æ›´æ–°)
        let accounts = {
            alice: 'feic1kpyhmumrt5g0veex9lhpzh3m99rptmmuz7cq8u',
            bob: 'feic1kfde52eamxnnwkn2yjv9uj5xuf0amxuh70tnpw'
        };
        
        let allWallets = [];
        let allValidators = [];

        // è·å–è´¦æˆ·åœ°å€çš„é€šç”¨å‡½æ•°
        function getAccountAddress(accountName) {
            // é¦–å…ˆæ£€æŸ¥é™æ€æ˜ å°„
            if (accounts[accountName]) {
                return accounts[accountName];
            }
            
            // ç„¶åæ£€æŸ¥åŠ¨æ€é’±åŒ…åˆ—è¡¨
            const wallet = allWallets.find(w => w.name === accountName);
            if (wallet) {
                return wallet.address;
            }
            
            // å¦‚æœå·²ç»æ˜¯åœ°å€æ ¼å¼ï¼Œç›´æ¥è¿”å›
            if (accountName && accountName.startsWith('feic1')) {
                return accountName;
            }
            
            console.error(`æ— æ³•æ‰¾åˆ°è´¦æˆ· ${accountName} çš„åœ°å€`);
            return null;
        }

        let autoRefreshInterval;
        let isAutoRefreshing = true;

        // æ·»åŠ æ—¥å¿—å‡½æ•°
        function addLog(level, message) {
            const logs = document.getElementById('blockchain-logs');
            const timestamp = new Date().toLocaleString();
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry';
            logEntry.innerHTML = `
                <span class="log-timestamp">[${timestamp}]</span>
                <span class="log-level-${level}">[${level.toUpperCase()}]</span> ${message}
            `;
            logs.insertBefore(logEntry, logs.firstChild);
            
            // ä¿æŒæœ€æ–°çš„100æ¡æ—¥å¿—
            while (logs.children.length > 100) {
                logs.removeChild(logs.lastChild);
            }
        }

        // æ·»åŠ è½¬è´¦ä¸“ç”¨æ—¥å¿—å‡½æ•°
        function addTransferLog(level, message) {
            const logs = document.getElementById('blockchain-logs');
            const timestamp = new Date().toLocaleString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry transfer-log`;
            logEntry.innerHTML = `
                <span class="log-timestamp">[${timestamp}]</span>
                <span class="log-level-${level}">[${level.toUpperCase()}]</span> ${message}
            `;
            logs.insertBefore(logEntry, logs.firstChild);
            
            // ä¿æŒæœ€æ–°çš„100æ¡æ—¥å¿—
            while (logs.children.length > 100) {
                logs.removeChild(logs.lastChild);
            }
        }

        // æ·»åŠ æˆåŠŸæ—¥å¿—å‡½æ•°
        function addSuccessLog(message) {
            const logs = document.getElementById('blockchain-logs');
            const timestamp = new Date().toLocaleString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry success-log`;
            logEntry.innerHTML = `
                <span class="log-timestamp">[${timestamp}]</span>
                <span class="log-level-success">[SUCCESS]</span> ${message}
            `;
            logs.insertBefore(logEntry, logs.firstChild);
            
            // ä¿æŒæœ€æ–°çš„100æ¡æ—¥å¿—
            while (logs.children.length > 100) {
                logs.removeChild(logs.lastChild);
            }
        }

        // æ·»åŠ åˆ†å‰²çº¿
        function addTransferSeparator() {
            const logs = document.getElementById('blockchain-logs');
            const separator = document.createElement('div');
            separator.className = 'transfer-separator';
            logs.insertBefore(separator, logs.firstChild);
        }

        // æ·»åŠ è½¬è´¦ç»“æŸåˆ†å‰²çº¿
        function addTransferEndSeparator() {
            const logs = document.getElementById('blockchain-logs');
            const separator = document.createElement('div');
            separator.className = 'transfer-end-separator';
            logs.insertBefore(separator, logs.firstChild);
        }

        // æ˜¾ç¤ºçŠ¶æ€ä¿¡æ¯
        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('transfer-status');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
            
            if (type !== 'loading') {
                setTimeout(() => {
                    statusDiv.innerHTML = '';
                }, 5000);
            }
        }
        
        // æ˜¾ç¤ºTokenå¢å‘çŠ¶æ€ä¿¡æ¯
        function showMintStatus(message, type = 'info') {
            const statusDiv = document.getElementById('mint-status');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
            
            if (type !== 'loading') {
                setTimeout(() => {
                    statusDiv.innerHTML = '';
                }, 5000);
            }
        }

        // è·å–ä½™é¢ - æ”¯æŒè´¦æˆ·åå’Œåœ°å€
        async function getBalance(account) {
            try {
                // å¦‚æœæ˜¯åœ°å€ç›´æ¥ä½¿ç”¨ï¼Œå¦‚æœæ˜¯è´¦æˆ·ååˆ™ä»accountsæŸ¥æ‰¾
                let address = account;
                if (accounts[account]) {
                    address = accounts[account];
                } else if (!account.startsWith('feic1')) {
                    // å¦‚æœä¸æ˜¯åœ°å€ä¹Ÿä¸åœ¨accountsä¸­ï¼Œå°è¯•ä»allWalletsæŸ¥æ‰¾
                    const wallet = allWallets.find(w => w.name === account);
                    if (wallet) {
                        address = wallet.address;
                    }
                }
                
                const response = await fetch(`http://localhost:1317/cosmos/bank/v1beta1/balances/${address}`);
                const data = await response.json();
                return data.balances;
            } catch (error) {
                addLog('error', `è·å–${account}ä½™é¢å¤±è´¥: ${error.message}`);
                return [];
            }
        }

        // åˆ·æ–°ä½™é¢æ˜¾ç¤º - ç°åœ¨æ›´æ–°é’±åŒ…åˆ—è¡¨ä¸­çš„ä½™é¢
        async function refreshBalances() {
            addLog('info', 'æ­£åœ¨åˆ·æ–°è´¦æˆ·ä½™é¢...');
            
            // å¦‚æœé’±åŒ…åˆ—è¡¨å·²åŠ è½½ï¼Œåˆ™åˆ·æ–°é’±åŒ…ä½™é¢æ˜¾ç¤º
            if (allWallets.length > 0) {
                for (const wallet of allWallets) {
                    try {
                        const balance = await getBalance(wallet.address);
                        const balanceElement = document.getElementById(`balance-${wallet.name}`);
                        if (balanceElement && balance.length > 0) {
                            const balanceHtml = balance.map(b => 
                                `${parseInt(b.amount).toLocaleString()} ${b.denom}`
                            ).join('<br>');
                            balanceElement.innerHTML = balanceHtml;
                        } else if (balanceElement) {
                            balanceElement.innerHTML = '0';
                        }
                    } catch (error) {
                        console.error(`åˆ·æ–°${wallet.name}ä½™é¢å¤±è´¥:`, error);
                    }
                }
            }
            
            addLog('info', 'é’±åŒ…ä½™é¢å·²æ›´æ–°');
        }

        // å…¨å±€å˜é‡
        let realTimeUpdateEnabled = true;
        let lastBlockTime = null;
        
        // è·å–åŒºå—é“¾çŠ¶æ€
        async function getBlockchainStatus() {
            try {
                // è·å–æœ€æ–°åŒºå—ä¿¡æ¯
                const blockResponse = await fetch('http://localhost:1317/cosmos/base/tendermint/v1beta1/blocks/latest');
                const blockData = await blockResponse.json();
                
                // è·å–èŠ‚ç‚¹ä¿¡æ¯
                const nodeResponse = await fetch('http://localhost:1317/cosmos/base/tendermint/v1beta1/node_info');
                const nodeData = await nodeResponse.json();
                
                // è·å–éªŒè¯è€…ä¿¡æ¯
                const validatorResponse = await fetch('http://localhost:1317/cosmos/staking/v1beta1/validators');
                const validatorData = await validatorResponse.json();
                
                // åŸºç¡€ä¿¡æ¯æ›´æ–°
                document.getElementById('block-height').textContent = blockData.block.header.height;
                document.getElementById('validator-count').textContent = validatorData.validators.length;
                document.getElementById('chain-id').textContent = nodeData.default_node_info.network;
                document.getElementById('block-time').textContent = new Date(blockData.block.header.time).toLocaleTimeString();
                
                // è®¡ç®—åŒºå—é—´éš”
                const currentBlockTime = new Date(blockData.block.header.time);
                if (lastBlockTime) {
                    const interval = Math.round((currentBlockTime - lastBlockTime) / 1000);
                    document.getElementById('block-interval').textContent = `${interval}s`;
                } else {
                    document.getElementById('block-interval').textContent = 'è®¡ç®—ä¸­...';
                }
                lastBlockTime = currentBlockTime;
                
                // åŒºå—è¯¦æƒ…
                document.getElementById('block-hash').textContent = blockData.block_id.hash.substring(0, 16) + '...';
                document.getElementById('tx-count').textContent = blockData.block.data.txs ? blockData.block.data.txs.length : 0;
                
                // è®¡ç®—åŒºå—å¤§å°
                const blockSize = JSON.stringify(blockData.block).length;
                document.getElementById('block-size').textContent = `${(blockSize / 1024).toFixed(1)} KB`;
                
                // è·å–å‡ºå—éªŒè¯è€…
                if (blockData.block.header.proposer_address) {
                    const proposerAddr = blockData.block.header.proposer_address;
                    const proposer = validatorData.validators.find(v => 
                        v.consensus_pubkey && v.consensus_pubkey.key
                    );
                    document.getElementById('proposer').textContent = proposer ? 
                        (proposer.description.moniker || 'æœªçŸ¥éªŒè¯è€…') : proposerAddr.substring(0, 8) + '...';
                } else {
                    document.getElementById('proposer').textContent = 'è·å–ä¸­...';
                }
                
                addLog('info', `åŒºå— #${blockData.block.header.height} å·²ç¡®è®¤ï¼ŒåŒ…å« ${blockData.block.data.txs ? blockData.block.data.txs.length : 0} ç¬”äº¤æ˜“`);
            } catch (error) {
                addLog('error', `è·å–åŒºå—é“¾çŠ¶æ€å¤±è´¥: ${error.message}`);
            }
        }
        
        // è·å–è´¨æŠ¼ä¿¡æ¯
        async function getStakingInfo() {
            try {
                // è·å–è´¨æŠ¼æ± ä¿¡æ¯
                const poolResponse = await fetch('http://localhost:1317/cosmos/staking/v1beta1/pool');
                const poolData = await poolResponse.json();
                
                // è·å–éªŒè¯è€…ä¿¡æ¯
                const validatorResponse = await fetch('http://localhost:1317/cosmos/staking/v1beta1/validators');
                const validatorData = await validatorResponse.json();
                
                // è·å–ä»£å¸æ€»ä¾›åº”é‡
                const supplyResponse = await fetch('http://localhost:1317/cosmos/bank/v1beta1/supply');
                const supplyData = await supplyResponse.json();
                
                // æ´»è·ƒéªŒè¯è€…æ•°é‡
                const activeValidators = validatorData.validators.filter(v => v.status === 'BOND_STATUS_BONDED').length;
                document.getElementById('active-validators').textContent = `${activeValidators}/${validatorData.validators.length}`;
                
                // æ€»è´¨æŠ¼é‡ - æ˜¾ç¤ºå®Œæ•´å°æ•°ä½
                const bondedTokens = parseInt(poolData.pool.bonded_tokens);
                const bondedAmount = (bondedTokens / 1000000).toFixed(6);
                document.getElementById('total-bonded').textContent = `${bondedAmount} stake`;
                
                // è´¨æŠ¼ç‡è®¡ç®— - æ›´ç²¾ç¡®çš„ç™¾åˆ†æ¯”
                const stakeSupply = supplyData.supply.find(s => s.denom === 'stake');
                if (stakeSupply) {
                    const totalStake = parseInt(stakeSupply.amount);
                    const bondedRatio = ((bondedTokens / totalStake) * 100).toFixed(4);
                    document.getElementById('bonded-ratio').textContent = `${bondedRatio}%`;
                } else {
                    document.getElementById('bonded-ratio').textContent = 'è®¡ç®—ä¸­...';
                }
                
            } catch (error) {
                console.error('è·å–è´¨æŠ¼ä¿¡æ¯å¤±è´¥:', error);
                document.getElementById('active-validators').textContent = 'è·å–å¤±è´¥';
                document.getElementById('total-bonded').textContent = 'è·å–å¤±è´¥';
                document.getElementById('bonded-ratio').textContent = 'è·å–å¤±è´¥';
            }
        }
        
        // è·å–æ²»ç†ä¿¡æ¯
        async function getGovernanceInfo() {
            try {
                // è·å–ææ¡ˆä¿¡æ¯
                const proposalsResponse = await fetch('http://localhost:1317/cosmos/gov/v1beta1/proposals');
                const proposalsData = await proposalsResponse.json();
                
                // è·å–é€šèƒ€ç‡
                const mintResponse = await fetch('http://localhost:1317/cosmos/mint/v1beta1/inflation');
                const mintData = await mintResponse.json();
                
                // è·å–ç¤¾åŒºæ± 
                const communityResponse = await fetch('http://localhost:1317/cosmos/distribution/v1beta1/community_pool');
                const communityData = await communityResponse.json();
                
                // æ›´æ–°ææ¡ˆä¿¡æ¯
                const totalProposals = proposalsData.proposals ? proposalsData.proposals.length : 0;
                document.getElementById('total-proposals').textContent = totalProposals;
                
                const activeProposals = proposalsData.proposals ? 
                    proposalsData.proposals.filter(p => p.status === 'PROPOSAL_STATUS_VOTING_PERIOD').length : 0;
                document.getElementById('active-proposals').textContent = activeProposals;
                
                // é€šèƒ€ç‡
                if (mintData.inflation) {
                    const inflation = (parseFloat(mintData.inflation) * 100).toFixed(2);
                    document.getElementById('inflation-rate').textContent = `${inflation}%`;
                } else {
                    document.getElementById('inflation-rate').textContent = '0.00%';
                }
                
                // ç¤¾åŒºæ±  - æ˜¾ç¤ºå°æ•°ä½
                if (communityData.pool && communityData.pool.length > 0) {
                    const stakeInPool = communityData.pool.find(coin => coin.denom === 'stake');
                    if (stakeInPool) {
                        const amount = (parseFloat(stakeInPool.amount) / 1000000).toFixed(6);
                        document.getElementById('community-pool').textContent = `${amount} stake`;
                    } else {
                        document.getElementById('community-pool').textContent = '0.000000 stake';
                    }
                } else {
                    document.getElementById('community-pool').textContent = '0.000000 stake';
                }
                
            } catch (error) {
                console.error('è·å–æ²»ç†ä¿¡æ¯å¤±è´¥:', error);
                document.getElementById('total-proposals').textContent = 'è·å–å¤±è´¥';
                document.getElementById('active-proposals').textContent = 'è·å–å¤±è´¥';
                document.getElementById('inflation-rate').textContent = 'è·å–å¤±è´¥';
                document.getElementById('community-pool').textContent = 'è·å–å¤±è´¥';
            }
        }
        
        // åˆ·æ–°æ‰€æœ‰åŒºå—é“¾æ•°æ®
        async function refreshAllBlockchainData() {
            const btn = document.getElementById('refresh-blockchain-btn');
            btn.textContent = 'ğŸ”„ åˆ·æ–°ä¸­...';
            btn.disabled = true;
            
            try {
                await Promise.all([
                    getBlockchainStatus(),
                    getStakingInfo(),
                    getGovernanceInfo()
                ]);
                addLog('info', 'âœ… æ‰€æœ‰åŒºå—é“¾æ•°æ®å·²åˆ·æ–°');
            } catch (error) {
                addLog('error', `âŒ åˆ·æ–°æ•°æ®å¤±è´¥: ${error.message}`);
            } finally {
                btn.textContent = 'ğŸ”„ åˆ·æ–°æ‰€æœ‰æ•°æ®';
                btn.disabled = false;
            }
        }
        
        // åˆ‡æ¢å®æ—¶æ›´æ–°
        function toggleRealTimeUpdate() {
            realTimeUpdateEnabled = !realTimeUpdateEnabled;
            const btn = document.getElementById('realtime-btn');
            
            if (realTimeUpdateEnabled) {
                btn.textContent = 'âš¡ å®æ—¶æ›´æ–°: å¼€å¯';
                btn.style.background = '#17a2b8';
                addLog('info', 'âœ… å®æ—¶æ›´æ–°å·²å¼€å¯');
            } else {
                btn.textContent = 'â¸ï¸ å®æ—¶æ›´æ–°: å…³é—­';
                btn.style.background = '#6c757d';
                addLog('info', 'â¸ï¸ å®æ—¶æ›´æ–°å·²å…³é—­');
            }
        }

        // çœŸå®è½¬è´¦åŠŸèƒ½ - ä½¿ç”¨ CLI å‘½ä»¤æ‰§è¡Œå®é™…è½¬è´¦
        async function sendTransfer() {
            const fromAccount = document.getElementById('from-account').value;
            const toAccount = document.getElementById('to-account').value;
            const amount = document.getElementById('amount').value;
            const denom = document.getElementById('denom').value;

            if (!amount || amount <= 0) {
                showStatus('è¯·è¾“å…¥æœ‰æ•ˆçš„è½¬è´¦é‡‘é¢', 'error');
                return;
            }

            if (fromAccount === toAccount) {
                showStatus('ä¸èƒ½å‘è‡ªå·±è½¬è´¦', 'error');
                return;
            }

            // éªŒè¯è´¦æˆ·åœ°å€
            const fromAddress = getAccountAddress(fromAccount);
            const toAddress = getAccountAddress(toAccount);
            
            if (!fromAddress) {
                showStatus(`æ— æ³•æ‰¾åˆ°å‘é€è´¦æˆ· ${fromAccount} çš„åœ°å€`, 'error');
                return;
            }
            
            if (!toAddress) {
                showStatus(`æ— æ³•æ‰¾åˆ°æ¥æ”¶è´¦æˆ· ${toAccount} çš„åœ°å€`, 'error');
                return;
            }

            // ç¦ç”¨æŒ‰é’®
            document.getElementById('transfer-btn').disabled = true;
            showStatus(`æ­£åœ¨å¤„ç†ä» ${fromAccount} åˆ° ${toAccount} çš„ ${amount} ${denom} è½¬è´¦...`, 'loading');
            
            // æ·»åŠ è½¬è´¦å¼€å§‹åˆ†å‰²çº¿
            addTransferSeparator();
            
            addTransferLog('transfer', `ğŸš€ çœŸå®è½¬è´¦äº¤æ˜“å¼€å§‹ï¼`);
            addTransferLog('transfer', `ğŸ“¤ å‘é€æ–¹: ${fromAccount.toUpperCase()} â†’ ${getAccountAddress(fromAccount)}`);
            addTransferLog('transfer', `ğŸ“¥ æ¥æ”¶æ–¹: ${toAccount.toUpperCase()} â†’ ${getAccountAddress(toAccount)}`);
            addTransferLog('transfer', `ğŸ’° è½¬è´¦é‡‘é¢: ${parseInt(amount).toLocaleString()} ${denom.toUpperCase()}`);
            
            try {
                addTransferLog('transfer', 'ğŸ” ç¬¬1æ­¥ï¼šéªŒè¯è´¦æˆ·ä½™é¢...');
                
                // æ£€æŸ¥å‘é€æ–¹ä½™é¢
                const senderBalance = await getBalance(fromAccount);
                const tokenBalance = senderBalance.find(b => b.denom === denom);
                
                if (!tokenBalance || parseInt(tokenBalance.amount) < parseInt(amount)) {
                    throw new Error(`ä½™é¢ä¸è¶³ã€‚éœ€è¦ ${amount} ${denom}ï¼Œä½†åªæœ‰ ${tokenBalance ? tokenBalance.amount : 0} ${denom}`);
                }
                
                addTransferLog('transfer', 'âœ… ä½™é¢éªŒè¯é€šè¿‡ - è´¦æˆ·èµ„é‡‘å……è¶³');
                addTransferLog('transfer', 'ğŸ” ç¬¬2æ­¥ï¼šé€šè¿‡è½¬è´¦æœåŠ¡å™¨æ‰§è¡Œäº¤æ˜“...');
                
                try {
                    const response = await fetch('http://localhost:3001/transfer', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            fromAccount: fromAccount,
                            toAccount: getAccountAddress(toAccount),
                            amount: amount,
                            denom: denom
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        addTransferLog('transfer', 'âœ… è½¬è´¦å‘½ä»¤æ‰§è¡ŒæˆåŠŸ');
                        addTransferLog('transfer', 'ğŸ“¡ ç¬¬3æ­¥ï¼šäº¤æ˜“å·²å¹¿æ’­åˆ°åŒºå—é“¾ç½‘ç»œ...');
                        
                        // ä»è¿”å›ç»“æœä¸­æå–äº¤æ˜“å“ˆå¸Œ
                        const txHashMatch = result.output.match(/txhash: ([A-F0-9]+)/);
                        const txHash = txHashMatch ? txHashMatch[1] : null;
                        
                        if (txHash) {
                            addTransferLog('transfer', `ğŸ“‹ äº¤æ˜“å“ˆå¸Œ: ${txHash}`);
                            addTransferLog('transfer', 'â›“ï¸ ç¬¬4æ­¥ï¼šç­‰å¾…åŒºå—é“¾ç½‘ç»œç¡®è®¤äº¤æ˜“...');
                            addTransferLog('transfer', 'ğŸ” å¼€å§‹ç›‘æ§äº¤æ˜“çŠ¶æ€...');
                            
                            // çœŸæ­£ç­‰å¾…åŒºå—ç¡®è®¤
                            let confirmed = false;
                            let attempts = 0;
                            const maxAttempts = 30; // æœ€å¤šç­‰å¾…30æ¬¡ï¼Œæ¯æ¬¡2ç§’
                            
                            while (!confirmed && attempts < maxAttempts) {
                                attempts++;
                                await new Promise(resolve => setTimeout(resolve, 2000));
                                
                                try {
                                    addTransferLog('transfer', `ğŸ”„ ç¬¬${attempts}æ¬¡æŸ¥è¯¢: æ£€æŸ¥äº¤æ˜“æ˜¯å¦è¢«æ‰“åŒ…åˆ°åŒºå—ä¸­...`);
                                    
                                    // æŸ¥è¯¢äº¤æ˜“çŠ¶æ€
                                    const txResponse = await fetch(`http://localhost:1317/cosmos/tx/v1beta1/txs/${txHash}`);
                                    
                                    if (txResponse.ok) {
                                        const txData = await txResponse.json();
                                        
                                        if (txData.tx_response) {
                                            const currentHeight = txData.tx_response.height;
                                            
                                            if (currentHeight === "0") {
                                                addTransferLog('transfer', `â³ äº¤æ˜“è¿˜åœ¨å†…å­˜æ± ä¸­ï¼Œç­‰å¾…éªŒè¯è€…æ‰“åŒ…...`);
                                                
                                                // æ˜¾ç¤ºç­‰å¾…è¿›åº¦
                                                const progress = Math.round((attempts / maxAttempts) * 100);
                                                addTransferLog('transfer', `ğŸ“Š ç­‰å¾…è¿›åº¦: ${progress}% (${attempts}/${maxAttempts})`);
                                            } else {
                                                confirmed = true;
                                                addTransferLog('transfer', `ğŸ‰ äº¤æ˜“æˆåŠŸæ‰“åŒ…ï¼åŒºå—é«˜åº¦: #${currentHeight}`);
                                                addTransferLog('transfer', `âœ… éªŒè¯è€…èŠ‚ç‚¹å·²éªŒè¯å¹¶ç¡®è®¤äº¤æ˜“`);
                                                addTransferLog('transfer', `ğŸ“¦ äº¤æ˜“å·²æ°¸ä¹…è®°å½•åœ¨åŒºå—é“¾ä¸Š`);
                                                addTransferLog('transfer', `â›½ Gas æ¶ˆè€—: ${txData.tx_response.gas_used}/${txData.tx_response.gas_wanted}`);
                                                
                                                // æ˜¾ç¤ºæ‰‹ç»­è´¹ä¿¡æ¯
                                                if (txData.tx && txData.tx.auth_info && txData.tx.auth_info.fee) {
                                                    const fee = txData.tx.auth_info.fee;
                                                    if (fee.amount && fee.amount.length > 0) {
                                                        const feeAmount = fee.amount.map(f => `${f.amount} ${f.denom}`).join(', ');
                                                        addTransferLog('transfer', `ğŸ’³ å®é™…æ‰‹ç»­è´¹: ${feeAmount}`);
                                                    } else {
                                                        addTransferLog('transfer', `ğŸ’³ å®é™…æ‰‹ç»­è´¹: å…è´¹äº¤æ˜“ (Gas Price = 0)`);
                                                    }
                                                } else {
                                                    addTransferLog('transfer', `ğŸ’³ æ‰‹ç»­è´¹ä¿¡æ¯: æœªè®¾ç½®æˆ–å…è´¹ç½‘ç»œ`);
                                                }
                                                
                                                addTransferLog('transfer', `ğŸ“… åŒºå—ç¡®è®¤æ—¶é—´: ${new Date(txData.tx_response.timestamp).toLocaleString()}`);
                                                
                                                // æ˜¾ç¤ºäº¤æ˜“è¯¦æƒ…
                                                if (txData.tx_response.events) {
                                                    const transferEvent = txData.tx_response.events.find(e => e.type === 'transfer');
                                                    if (transferEvent) {
                                                        const amountAttr = transferEvent.attributes.find(a => a.key === 'amount');
                                                        if (amountAttr) {
                                                            addTransferLog('transfer', `ğŸ’° é“¾ä¸Šç¡®è®¤é‡‘é¢: ${amountAttr.value}`);
                                                        }
                                                    }
                                                }
                                                break;
                                            }
                                        } else {
                                            addTransferLog('transfer', `âš ï¸ äº¤æ˜“æ•°æ®æ ¼å¼å¼‚å¸¸ï¼Œç»§ç»­ç­‰å¾…...`);
                                        }
                                    } else {
                                        addTransferLog('transfer', `ğŸ” äº¤æ˜“è¿˜æœªè¢«ç½‘ç»œæ¥æ”¶ï¼Œç»§ç»­ç›‘æ§...`);
                                    }
                                } catch (queryError) {
                                    addTransferLog('transfer', `âš ï¸ ç½‘ç»œæŸ¥è¯¢å¤±è´¥: ${queryError.message}`);
                                    addTransferLog('transfer', `ğŸ”„ å°†åœ¨2ç§’åé‡è¯•...`);
                                }
                            }
                            
                            if (!confirmed) {
                                addTransferLog('transfer', 'â° è¶…æ—¶ï¼šæœªèƒ½åœ¨é¢„æœŸæ—¶é—´å†…ç¡®è®¤ï¼Œä½†äº¤æ˜“å¯èƒ½ä»åœ¨å¤„ç†ä¸­');
                            }
                        } else {
                            addTransferLog('transfer', 'âš ï¸ æœªèƒ½è·å–äº¤æ˜“å“ˆå¸Œï¼Œä½¿ç”¨å¤‡ç”¨ç¡®è®¤æ–¹å¼');
                            await new Promise(resolve => setTimeout(resolve, 5000));
                        }
                        
                        addTransferLog('transfer', 'ğŸ” ç¬¬5æ­¥ï¼šéªŒè¯äº¤æ˜“ç»“æœ...');
                        
                        // æ£€æŸ¥ä½™é¢å˜åŒ–
                        const newSenderBalance = await getBalance(fromAccount);
                        const newReceiverBalance = await getBalance(toAccount);
                        
                        const newSenderTokenBalance = newSenderBalance.find(b => b.denom === denom);
                        const newReceiverTokenBalance = newReceiverBalance.find(b => b.denom === denom);
                        
                        // æ¯”è¾ƒä½™é¢å˜åŒ–
                        const oldSenderAmount = parseInt(tokenBalance.amount);
                        const newSenderAmount = newSenderTokenBalance ? parseInt(newSenderTokenBalance.amount) : 0;
                        
                        if (newSenderAmount < oldSenderAmount) {
                            addSuccessLog('ğŸ‰ è½¬è´¦æˆåŠŸï¼äº¤æ˜“å·²åœ¨åŒºå—é“¾ä¸Šç¡®è®¤');
                            addSuccessLog(`ğŸ’¸ ${fromAccount.toUpperCase()} ä½™é¢å‡å°‘ ${oldSenderAmount - newSenderAmount} ${denom}`);
                            addSuccessLog(`ğŸ’° ${toAccount.toUpperCase()} å½“å‰ä½™é¢: ${newReceiverTokenBalance ? parseInt(newReceiverTokenBalance.amount).toLocaleString() : 0} ${denom}`);
                            addSuccessLog('ğŸ“Š çœŸå®åŒºå—é“¾äº¤æ˜“å®Œæˆ');
                            showStatus(`ğŸ‰ è½¬è´¦æˆåŠŸï¼ä» ${fromAccount} å‘ ${toAccount} è½¬è´¦ ${amount} ${denom}`, 'success');
                        } else {
                            addTransferLog('transfer', 'âš ï¸ ä½™é¢æœªå˜åŒ–ï¼Œå¯èƒ½éœ€è¦æ›´å¤šæ—¶é—´ç¡®è®¤');
                            showStatus('è½¬è´¦å·²æäº¤ï¼Œè¯·ç¨åæŸ¥çœ‹ä½™é¢å˜åŒ–', 'success');
                        }
                        
                        // æ·»åŠ è½¬è´¦ç»“æŸåˆ†å‰²çº¿
                        addTransferEndSeparator();
                        
                        // åˆ·æ–°ä½™é¢æ˜¾ç¤º
                        refreshBalances();
                        
                        // é‡æ–°å¯ç”¨è½¬è´¦æŒ‰é’®
                        document.getElementById('transfer-btn').disabled = false;
                        
                    } else {
                        throw new Error(result.error || 'è½¬è´¦æœåŠ¡å™¨è¿”å›é”™è¯¯');
                    }
                    
                } catch (transferError) {
                    addTransferLog('transfer', 'âŒ è‡ªåŠ¨è½¬è´¦å¤±è´¥ï¼Œå°è¯•æ‰‹åŠ¨æ–¹å¼...');
                    addTransferLog('transfer', `é”™è¯¯ä¿¡æ¯: ${transferError.message}`);
                    
                    // æä¾›æ‰‹åŠ¨å‘½ä»¤ä½œä¸ºå¤‡é€‰æ–¹æ¡ˆ
                    const toAddress = getAccountAddress(toAccount);
                    if (toAddress) {
                        const transferCommand = `/Users/ggbond/go/bin/feicoind tx bank send ${fromAccount} ${toAddress} ${amount}${denom} --from ${fromAccount} --keyring-backend test --chain-id feicoin --yes --node http://localhost:26657`;
                        addTransferLog('transfer', 'ğŸ“‹ è¯·åœ¨ç»ˆç«¯æ‰‹åŠ¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤:');
                        addTransferLog('transfer', `ğŸ”§ ${transferCommand}`);
                    } else {
                        addTransferLog('transfer', 'âŒ æ— æ³•ç”Ÿæˆæ‰‹åŠ¨å‘½ä»¤ï¼šç›®æ ‡è´¦æˆ·åœ°å€æ— æ•ˆ');
                    }
                    
                    // 10ç§’åæ£€æŸ¥ä½™é¢å˜åŒ–
                    setTimeout(async () => {
                        refreshBalances();
                        addTransferLog('transfer', 'ğŸ”„ å·²åˆ·æ–°ä½™é¢ï¼Œå¦‚æœ‰å˜åŒ–åˆ™è¡¨ç¤ºè½¬è´¦æˆåŠŸ');
                        addTransferEndSeparator();
                        // é‡æ–°å¯ç”¨è½¬è´¦æŒ‰é’®
                        document.getElementById('transfer-btn').disabled = false;
                    }, 10000);
                    
                    showStatus('è‡ªåŠ¨è½¬è´¦å¤±è´¥ï¼Œè¯·æŸ¥çœ‹æ—¥å¿—ä¸­çš„æ‰‹åŠ¨å‘½ä»¤', 'error');
                }
                
            } catch (error) {
                addLog('error', `âŒ è½¬è´¦å¤±è´¥: ${error.message}`);
                addTransferEndSeparator();
                showStatus('è½¬è´¦å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œè´¦æˆ·çŠ¶æ€', 'error');
                // é‡æ–°å¯ç”¨æŒ‰é’®
                document.getElementById('transfer-btn').disabled = false;
            }
        }

        // æ¸…é™¤æ—¥å¿—
        function clearLogs() {
            document.getElementById('blockchain-logs').innerHTML = '';
            addLog('info', 'æ—¥å¿—å·²æ¸…é™¤');
        }

        // åˆ‡æ¢è‡ªåŠ¨åˆ·æ–°
        function toggleAutoRefresh() {
            const button = document.getElementById('auto-refresh-text');
            if (isAutoRefreshing) {
                clearInterval(autoRefreshInterval);
                isAutoRefreshing = false;
                button.textContent = 'â–¶ï¸ å¼€å§‹è‡ªåŠ¨åˆ·æ–°';
                addLog('info', 'è‡ªåŠ¨åˆ·æ–°å·²åœæ­¢');
            } else {
                startAutoRefresh();
                isAutoRefreshing = true;
                button.textContent = 'â¸ï¸ åœæ­¢è‡ªåŠ¨åˆ·æ–°';
                addLog('info', 'è‡ªåŠ¨åˆ·æ–°å·²å¯åŠ¨');
            }
        }

        // å¯åŠ¨è‡ªåŠ¨åˆ·æ–°
        function startAutoRefresh() {
            autoRefreshInterval = setInterval(() => {
                if (realTimeUpdateEnabled) {
                    refreshBalances();
                    getBlockchainStatus();
                    getStakingInfo();
                    getGovernanceInfo();
                }
            }, 10000); // æ¯10ç§’åˆ·æ–°ä¸€æ¬¡
        }

        // çœŸå®åŒºå—é“¾äº‹ä»¶ç›‘æ§
        let lastBlockHeight = 0;
        function monitorBlockchainEvents() {
            setInterval(async () => {
                try {
                    // è·å–æœ€æ–°åŒºå—ä¿¡æ¯
                    const response = await fetch('http://localhost:1317/cosmos/base/tendermint/v1beta1/blocks/latest');
                    const data = await response.json();
                    const currentHeight = parseInt(data.block.header.height);
                    
                    // æ£€æµ‹æ–°åŒºå—
                    if (lastBlockHeight > 0 && currentHeight > lastBlockHeight) {
                        const newBlocks = currentHeight - lastBlockHeight;
                        if (newBlocks === 1) {
                            addLog('info', `â›“ï¸ æ–°åŒºå— #${currentHeight} å·²ç”Ÿæˆ`);
                        } else {
                            addLog('info', `â›“ï¸ æ£€æµ‹åˆ° ${newBlocks} ä¸ªæ–°åŒºå—ï¼Œå½“å‰é«˜åº¦: ${currentHeight}`);
                        }
                        
                        // æ£€æŸ¥åŒºå—ä¸­æ˜¯å¦æœ‰äº¤æ˜“
                        const txCount = data.block.data.txs ? data.block.data.txs.length : 0;
                        if (txCount > 0) {
                            addLog('info', `ğŸ“¦ åŒºå— #${currentHeight} åŒ…å« ${txCount} ç¬”äº¤æ˜“`);
                        }
                        
                        // åŒæ—¶æ›´æ–°é¡µé¢æ˜¾ç¤ºçš„åŒºå—é«˜åº¦
                        document.getElementById('block-height').textContent = currentHeight;
                    }
                    
                    lastBlockHeight = currentHeight;
                } catch (error) {
                    // é™é»˜å¤„ç†é”™è¯¯ï¼Œé¿å…æ—¥å¿—å™ªéŸ³
                }
            }, 5000); // æ¯5ç§’æ£€æŸ¥ä¸€æ¬¡æ–°åŒºå—
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('load', async () => {
            addLog('info', 'ğŸš€ FeiCoin åŒºå—é“¾æµè§ˆå™¨å·²å¯åŠ¨');
            addLog('info', 'ğŸ”— æ­£åœ¨è¿æ¥åˆ°æœ¬åœ°èŠ‚ç‚¹...');
            
            try {
                // åˆå§‹åŒ–Tabé¡µé¢
                initializeTabs();
                
                // åˆå§‹åŒ–åŒºå—é“¾æ•°æ®
                await refreshAllBlockchainData();
                addLog('info', 'âœ… æˆåŠŸè¿æ¥åˆ°åŒºå—é“¾ç½‘ç»œ');
                
                // åˆå§‹åŒ–é’±åŒ…å’ŒéªŒè¯è€…åˆ—è¡¨
                await refreshWalletList();
                await refreshValidatorList();
                
                // åˆå§‹åŒ–Tokenç»Ÿè®¡
                await refreshTokenStats();
                
                // åˆå§‹åŒ–å¥–åŠ±ç®¡ç†
                await refreshRewards();
                
                // å¯åŠ¨è‡ªåŠ¨åˆ·æ–°
                startAutoRefresh();
                
                // å¯åŠ¨çœŸå®åŒºå—é“¾äº‹ä»¶ç›‘æ§
                monitorBlockchainEvents();
                
            } catch (error) {
                addLog('error', `âŒ è¿æ¥å¤±è´¥: ${error.message}`);
                addLog('warning', 'è¯·ç¡®ä¿åŒºå—é“¾èŠ‚ç‚¹æ­£åœ¨è¿è¡Œ (ignite chain serve)');
            }
        });

        // ===========================================
        // Tokenç®¡ç†åŠŸèƒ½
        // ===========================================
        
        let tokenStats = {
            totalSupply: { token: 0, stake: 0 },
            circulation: { token: 0, stake: 0 },
            holders: { token: 0, stake: 0 }
        };
        
        // æ˜¾ç¤ºTokenå¢å‘è¡¨å•
        async function showMintTokenForm() {
            hideMintTokenForm();
            document.getElementById('mint-token-form').style.display = 'block';
            
            // å¦‚æœé’±åŒ…åˆ—è¡¨ä¸ºç©ºï¼Œå…ˆåˆ·æ–°é’±åŒ…åˆ—è¡¨
            if (allWallets.length === 0) {
                addLog('info', 'ğŸ”„ æ­£åœ¨åŠ è½½é’±åŒ…åˆ—è¡¨...');
                await refreshWalletList();
            }
            
            updateMintAccountOptions();
            setupMintFormListeners();
        }
        
        // è®¾ç½®å¢å‘è¡¨å•ç›‘å¬å™¨
        function setupMintFormListeners() {
            const toAccountSelect = document.getElementById('mint-to-account');
            const toAccountCustom = document.getElementById('mint-to-custom');
            
            // å½“é€‰æ‹©ä¸‹æ‹‰æ¡†æ—¶ï¼Œæ¸…ç©ºè‡ªå®šä¹‰è¾“å…¥æ¡†
            toAccountSelect.addEventListener('change', function() {
                if (this.value) {
                    toAccountCustom.value = '';
                }
            });
            
            // å½“åœ¨è‡ªå®šä¹‰è¾“å…¥æ¡†è¾“å…¥æ—¶ï¼Œæ¸…ç©ºä¸‹æ‹‰æ¡†é€‰æ‹©
            toAccountCustom.addEventListener('input', function() {
                if (this.value.trim()) {
                    toAccountSelect.value = '';
                }
            });
        }
        
        // éšè—Tokenå¢å‘è¡¨å•
        function hideMintTokenForm() {
            document.getElementById('mint-token-form').style.display = 'none';
            
            // é‡ç½®æŒ‰é’®çŠ¶æ€
            const mintBtn = document.getElementById('mint-btn');
            if (mintBtn) {
                mintBtn.disabled = false;
                mintBtn.textContent = 'ğŸ”¨ æ‰§è¡Œå¢å‘';
            }
        }
        
        // æ›´æ–°å¢å‘è´¦æˆ·é€‰é¡¹
        function updateMintAccountOptions() {
            const fromSelect = document.getElementById('mint-from-account');
            const toSelect = document.getElementById('mint-to-account');
            
            if (allWallets.length > 0) {
                // æ›´æ–°å‘é€æ–¹è´¦æˆ·é€‰é¡¹
                if (fromSelect) {
                    fromSelect.innerHTML = '<option value="">é€‰æ‹©ç®¡ç†å‘˜è´¦æˆ·</option>';
                    allWallets.forEach(wallet => {
                        fromSelect.innerHTML += `<option value="${wallet.name}">${wallet.name}</option>`;
                    });
                }
                
                // æ›´æ–°æ¥æ”¶æ–¹è´¦æˆ·é€‰é¡¹
                if (toSelect) {
                    toSelect.innerHTML = '<option value="">é€‰æ‹©æ¥æ”¶è´¦æˆ·</option>';
                    allWallets.forEach(wallet => {
                        toSelect.innerHTML += `<option value="${wallet.address}" data-name="${wallet.name}">${wallet.name} (${wallet.address})</option>`;
                    });
                }
                
                addLog('info', `âœ… å·²åŠ è½½ ${allWallets.length} ä¸ªé’±åŒ…åˆ°å¢å‘è¡¨å•`);
            } else {
                // é’±åŒ…åˆ—è¡¨ä¸ºç©ºæ—¶çš„å¤„ç†
                if (fromSelect) {
                    fromSelect.innerHTML = '<option value="">æ­£åœ¨åŠ è½½é’±åŒ…...</option>';
                }
                if (toSelect) {
                    toSelect.innerHTML = '<option value="">æ­£åœ¨åŠ è½½é’±åŒ…...</option>';
                }
                addLog('warning', 'âš ï¸ é’±åŒ…åˆ—è¡¨ä¸ºç©ºï¼Œè¯·æ£€æŸ¥èŠ‚ç‚¹è¿æ¥çŠ¶æ€');
            }
        }
        
        // æ‰§è¡ŒTokenå¢å‘
        async function mintTokens() {
            console.log('mintTokenså‡½æ•°è¢«è°ƒç”¨');
            addLog('info', 'ğŸ”„ å¼€å§‹æ‰§è¡ŒTokenå¢å‘...');
            
            const fromAccount = document.getElementById('mint-from-account').value;
            const toAccountSelect = document.getElementById('mint-to-account').value.trim();
            const toAccountCustom = document.getElementById('mint-to-custom').value.trim();
            const amount = document.getElementById('mint-amount').value;
            const denom = document.getElementById('mint-denom').value;
            
            console.log('è¡¨å•æ•°æ®:', { fromAccount, toAccountSelect, toAccountCustom, amount, denom });
            
            // ç¡®å®šæ¥æ”¶åœ°å€ï¼šä¼˜å…ˆä½¿ç”¨é€‰æ‹©çš„è´¦æˆ·ï¼Œå…¶æ¬¡ä½¿ç”¨è‡ªå®šä¹‰è¾“å…¥
            let toAccount = toAccountSelect || toAccountCustom;
            
            if (!fromAccount || !toAccount || !amount || !denom) {
                showMintStatus('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µ', 'error');
                return;
            }
            
            if (!toAccount.startsWith('feic1')) {
                showMintStatus('æ¥æ”¶åœ°å€æ ¼å¼ä¸æ­£ç¡®ï¼Œåº”ä»¥feic1å¼€å¤´', 'error');
                return;
            }
            
            // è·å–é€‰ä¸­è´¦æˆ·çš„åç§°ç”¨äºæ˜¾ç¤º
            let toAccountDisplayName = toAccount;
            if (toAccountSelect) {
                const selectedOption = document.querySelector(`#mint-to-account option[value="${toAccountSelect}"]`);
                if (selectedOption) {
                    toAccountDisplayName = selectedOption.getAttribute('data-name') || selectedOption.textContent;
                }
            }
            
            // ç¦ç”¨å¢å‘æŒ‰é’®
            const mintBtn = document.getElementById('mint-btn');
            mintBtn.disabled = true;
            mintBtn.textContent = 'ğŸ”¨ å¢å‘ä¸­...';
            
            showMintStatus(`æ­£åœ¨å¤„ç† ${amount} ${denom} çš„å¢å‘æ“ä½œ...`, 'loading');
            
            try {
                addLog('info', `ğŸ”¨ æ­£åœ¨å¢å‘ ${amount} ${denom} åˆ° ${toAccountDisplayName} (${toAccount})`);
                
                // æ³¨æ„ï¼šçœŸå®çš„åŒºå—é“¾ä¸­ï¼Œå¢å‘é€šå¸¸éœ€è¦ç‰¹æ®Šæƒé™æˆ–æ²»ç†ææ¡ˆ
                // è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨è½¬è´¦çš„æ–¹å¼æ¨¡æ‹Ÿå¢å‘ï¼ˆä»ç®¡ç†å‘˜è´¦æˆ·è½¬è´¦ï¼‰
                const response = await fetch('http://localhost:3001/token/mint', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        fromAccount: fromAccount,
                        toAccount: toAccount,
                        amount: amount,
                        denom: denom
                    })
                });
                
                const result = await response.json();
                if (result.success) {
                    addSuccessLog(`ğŸ‰ æ¨¡æ‹Ÿå¢å‘æˆåŠŸ! ${amount} ${denom} å·²ä» ${fromAccount} è½¬è´¦åˆ° ${toAccountDisplayName}`);
                    addLog('info', `ğŸ“Š æ³¨æ„ï¼šè¿™æ˜¯æ¨¡æ‹Ÿå¢å‘ï¼ˆè½¬è´¦ï¼‰ï¼Œæ€»ä¾›åº”é‡ä¸å˜ã€‚çœŸå®å¢å‘éœ€è¦mintæƒé™`);
                    showMintStatus(`ğŸ‰ æ¨¡æ‹Ÿå¢å‘æˆåŠŸï¼${amount} ${denom} å·²è½¬è´¦åˆ° ${toAccountDisplayName}`, 'success');
                    
                    // æ¸…ç©ºè¡¨å•
                    document.getElementById('mint-to-account').value = '';
                    document.getElementById('mint-to-custom').value = '';
                    document.getElementById('mint-amount').value = '';
                    
                    // é‡æ–°å¯ç”¨æŒ‰é’®
                    mintBtn.disabled = false;
                    mintBtn.textContent = 'ğŸ”¨ æ‰§è¡Œå¢å‘';
                    
                    // åˆ·æ–°ç»Ÿè®¡æ•°æ®
                    setTimeout(() => {
                        refreshTokenStats();
                        refreshWalletList();
                        hideMintTokenForm();
                    }, 3000);
                } else {
                    addLog('error', `âŒ Tokenå¢å‘å¤±è´¥: ${result.error}`);
                    showMintStatus(`âŒ å¢å‘å¤±è´¥: ${result.error}`, 'error');
                    // é‡æ–°å¯ç”¨æŒ‰é’®
                    mintBtn.disabled = false;
                    mintBtn.textContent = 'ğŸ”¨ æ‰§è¡Œå¢å‘';
                }
            } catch (error) {
                addLog('error', `âŒ Tokenå¢å‘å¤±è´¥: ${error.message}`);
                showMintStatus(`âŒ ç½‘ç»œé”™è¯¯: ${error.message}`, 'error');
                // é‡æ–°å¯ç”¨æŒ‰é’®
                mintBtn.disabled = false;
                mintBtn.textContent = 'ğŸ”¨ æ‰§è¡Œå¢å‘';
            }
        }
        
        // åˆ·æ–°Tokenç»Ÿè®¡æ•°æ®
        async function refreshTokenStats() {
            try {
                addLog('info', 'ğŸ”„ æ­£åœ¨åˆ·æ–°Tokenç»Ÿè®¡æ•°æ®...');
                
                // 1. è·å–é“¾ä¸ŠçœŸå®æ€»ä¾›åº”é‡
                let chainTokenTotal = 0;
                let chainStakeTotal = 0;
                
                try {
                    const totalSupplyResponse = await fetch('http://localhost:1317/cosmos/bank/v1beta1/supply');
                    const totalSupplyData = await totalSupplyResponse.json();
                    
                    if (totalSupplyData.supply) {
                        const tokenSupply = totalSupplyData.supply.find(s => s.denom === 'token');
                        const stakeSupply = totalSupplyData.supply.find(s => s.denom === 'stake');
                        
                        chainTokenTotal = tokenSupply ? parseInt(tokenSupply.amount) : 0;
                        chainStakeTotal = stakeSupply ? parseInt(stakeSupply.amount) : 0;
                    }
                } catch (error) {
                    console.error('è·å–é“¾ä¸Šæ€»ä¾›åº”é‡å¤±è´¥:', error);
                }
                
                // 2. è®¡ç®—é’±åŒ…ä¸­çš„æŒæœ‰è€…æ•°é‡ï¼ˆç”¨äºç»Ÿè®¡æŒæœ‰è€…ï¼‰
                let tokenHolders = 0;
                let stakeHolders = 0;
                let walletTokenTotal = 0;
                let walletStakeTotal = 0;
                
                for (const wallet of allWallets) {
                    try {
                        const balance = await getBalance(wallet.address);
                        
                        const tokenBalance = balance.find(b => b.denom === 'token');
                        const stakeBalance = balance.find(b => b.denom === 'stake');
                        
                        if (tokenBalance && parseInt(tokenBalance.amount) > 0) {
                            walletTokenTotal += parseInt(tokenBalance.amount);
                            tokenHolders++;
                        }
                        
                        if (stakeBalance && parseInt(stakeBalance.amount) > 0) {
                            walletStakeTotal += parseInt(stakeBalance.amount);
                            stakeHolders++;
                        }
                    } catch (error) {
                        console.error(`è·å–${wallet.name}ä½™é¢å¤±è´¥:`, error);
                    }
                }
                
                // 3. æ›´æ–°ç»Ÿè®¡æ˜¾ç¤ºï¼ˆä½¿ç”¨é“¾ä¸ŠçœŸå®æ€»é‡ï¼‰
                document.getElementById('token-total-supply').textContent = `${chainTokenTotal.toLocaleString()} token / ${chainStakeTotal.toLocaleString()} stake`;
                document.getElementById('token-circulation').textContent = `${chainTokenTotal.toLocaleString()} token / ${chainStakeTotal.toLocaleString()} stake`;
                document.getElementById('token-holders').textContent = `Token: ${tokenHolders}+ / Stake: ${stakeHolders}+ (é’±åŒ…å†…)`;
                
                // 4. æ›´æ–°å…¨å±€ç»Ÿè®¡
                tokenStats = {
                    totalSupply: { token: chainTokenTotal, stake: chainStakeTotal },
                    circulation: { token: chainTokenTotal, stake: chainStakeTotal },
                    holders: { token: tokenHolders, stake: stakeHolders }
                };
                
                addLog('info', `âœ… Tokenç»Ÿè®¡å·²æ›´æ–° - é“¾ä¸Šæ€»é‡ Token: ${chainTokenTotal.toLocaleString()}, Stake: ${chainStakeTotal.toLocaleString()}`);
                addLog('info', `ğŸ“Š é’±åŒ…å†…ç»Ÿè®¡ - Token: ${walletTokenTotal.toLocaleString()}, Stake: ${walletStakeTotal.toLocaleString()}`);
                
            } catch (error) {
                addLog('error', `âŒ åˆ·æ–°Tokenç»Ÿè®¡å¤±è´¥: ${error.message}`);
            }
        }
        
        // æ˜¾ç¤ºTokenåˆ†å¸ƒ
        function showTokenDistribution() {
            document.getElementById('token-distribution-section').style.display = 'block';
            refreshTokenDistribution();
        }
        
        // éšè—Tokenåˆ†å¸ƒ
        function hideTokenDistribution() {
            document.getElementById('token-distribution-section').style.display = 'none';
        }
        
        // æ˜¾ç¤ºçœŸå®å¢å‘è¯´æ˜
        function showRealMintInfo() {
            document.getElementById('real-mint-info').style.display = 'block';
        }
        
        // éšè—çœŸå®å¢å‘è¯´æ˜
        function hideRealMintInfo() {
            document.getElementById('real-mint-info').style.display = 'none';
        }
        
        // æ˜¾ç¤ºçœŸå®å¢å‘è¡¨å•
        async function showRealMintForm() {
            hideRealMintTokenForm();
            document.getElementById('real-mint-token-form').style.display = 'block';
            
            // å¦‚æœé’±åŒ…åˆ—è¡¨ä¸ºç©ºï¼Œå…ˆåˆ·æ–°é’±åŒ…åˆ—è¡¨
            if (allWallets.length === 0) {
                addLog('info', 'ğŸ”„ æ­£åœ¨åŠ è½½é’±åŒ…åˆ—è¡¨...');
                await refreshWalletList();
            }
            
            updateRealMintAccountOptions();
            setupRealMintFormListeners();
        }
        
        // éšè—çœŸå®å¢å‘è¡¨å•
        function hideRealMintTokenForm() {
            document.getElementById('real-mint-token-form').style.display = 'none';
            
            // é‡ç½®æŒ‰é’®çŠ¶æ€
            const realMintBtn = document.getElementById('real-mint-btn');
            if (realMintBtn) {
                realMintBtn.disabled = false;
                realMintBtn.textContent = 'ğŸ’ æäº¤å¢å‘ææ¡ˆ';
            }
        }
        
        // æ›´æ–°çœŸå®å¢å‘è´¦æˆ·é€‰é¡¹
        function updateRealMintAccountOptions() {
            const fromSelect = document.getElementById('real-mint-from-account');
            const toSelect = document.getElementById('real-mint-to-account');
            
            if (allWallets.length > 0) {
                // æ›´æ–°ææ¡ˆæäº¤è€…é€‰é¡¹
                if (fromSelect) {
                    fromSelect.innerHTML = '<option value="">é€‰æ‹©ææ¡ˆæäº¤è€…</option>';
                    allWallets.forEach(wallet => {
                        fromSelect.innerHTML += `<option value="${wallet.name}">${wallet.name}</option>`;
                    });
                }
                
                // æ›´æ–°æ¥æ”¶æ–¹è´¦æˆ·é€‰é¡¹
                if (toSelect) {
                    toSelect.innerHTML = '<option value="">é€‰æ‹©æ¥æ”¶è´¦æˆ·</option>';
                    allWallets.forEach(wallet => {
                        toSelect.innerHTML += `<option value="${wallet.address}" data-name="${wallet.name}">${wallet.name} (${wallet.address})</option>`;
                    });
                }
                
                addLog('info', `âœ… å·²åŠ è½½ ${allWallets.length} ä¸ªé’±åŒ…åˆ°çœŸå®å¢å‘è¡¨å•`);
            } else {
                // é’±åŒ…åˆ—è¡¨ä¸ºç©ºæ—¶çš„å¤„ç†
                if (fromSelect) {
                    fromSelect.innerHTML = '<option value="">æ­£åœ¨åŠ è½½é’±åŒ…...</option>';
                }
                if (toSelect) {
                    toSelect.innerHTML = '<option value="">æ­£åœ¨åŠ è½½é’±åŒ…...</option>';
                }
                addLog('warning', 'âš ï¸ é’±åŒ…åˆ—è¡¨ä¸ºç©ºï¼Œè¯·æ£€æŸ¥èŠ‚ç‚¹è¿æ¥çŠ¶æ€');
            }
        }
        
        // è®¾ç½®çœŸå®å¢å‘è¡¨å•ç›‘å¬å™¨
        function setupRealMintFormListeners() {
            const toAccountSelect = document.getElementById('real-mint-to-account');
            const toAccountCustom = document.getElementById('real-mint-to-custom');
            
            // å½“é€‰æ‹©ä¸‹æ‹‰æ¡†æ—¶ï¼Œæ¸…ç©ºè‡ªå®šä¹‰è¾“å…¥æ¡†
            toAccountSelect.addEventListener('change', function() {
                if (this.value) {
                    toAccountCustom.value = '';
                }
            });
            
            // å½“åœ¨è‡ªå®šä¹‰è¾“å…¥æ¡†è¾“å…¥æ—¶ï¼Œæ¸…ç©ºä¸‹æ‹‰æ¡†é€‰æ‹©
            toAccountCustom.addEventListener('input', function() {
                if (this.value.trim()) {
                    toAccountSelect.value = '';
                }
            });
        }
        
        // æ˜¾ç¤ºçœŸå®å¢å‘çŠ¶æ€ä¿¡æ¯
        function showRealMintStatus(message, type = 'info') {
            const statusDiv = document.getElementById('real-mint-status');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
            
            if (type !== 'loading') {
                setTimeout(() => {
                    statusDiv.innerHTML = '';
                }, 10000); // çœŸå®å¢å‘ææ¡ˆç»“æœæ˜¾ç¤ºæ›´é•¿æ—¶é—´
            }
        }
        
        // æ‰§è¡ŒçœŸå®Tokenå¢å‘
        async function realMintTokens() {
            console.log('realMintTokenså‡½æ•°è¢«è°ƒç”¨');
            addLog('info', 'ğŸ’ å¼€å§‹æ‰§è¡ŒçœŸå®Tokenå¢å‘ææ¡ˆ...');
            
            const fromAccount = document.getElementById('real-mint-from-account').value;
            const toAccountSelect = document.getElementById('real-mint-to-account').value.trim();
            const toAccountCustom = document.getElementById('real-mint-to-custom').value.trim();
            const amount = document.getElementById('real-mint-amount').value;
            const denom = document.getElementById('real-mint-denom').value;
            const title = document.getElementById('real-mint-title').value.trim();
            const description = document.getElementById('real-mint-description').value.trim();
            
            console.log('çœŸå®å¢å‘è¡¨å•æ•°æ®:', { fromAccount, toAccountSelect, toAccountCustom, amount, denom, title, description });
            
            // ç¡®å®šæ¥æ”¶åœ°å€ï¼šä¼˜å…ˆä½¿ç”¨é€‰æ‹©çš„è´¦æˆ·ï¼Œå…¶æ¬¡ä½¿ç”¨è‡ªå®šä¹‰è¾“å…¥
            let toAccount = toAccountSelect || toAccountCustom;
            
            if (!fromAccount || !toAccount || !amount || !denom) {
                showRealMintStatus('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µ', 'error');
                return;
            }
            
            if (!toAccount.startsWith('feic1')) {
                showRealMintStatus('æ¥æ”¶åœ°å€æ ¼å¼ä¸æ­£ç¡®ï¼Œåº”ä»¥feic1å¼€å¤´', 'error');
                return;
            }
            
            // è·å–é€‰ä¸­è´¦æˆ·çš„åç§°ç”¨äºæ˜¾ç¤º
            let toAccountDisplayName = toAccount;
            if (toAccountSelect) {
                const selectedOption = document.querySelector(`#real-mint-to-account option[value="${toAccountSelect}"]`);
                if (selectedOption) {
                    toAccountDisplayName = selectedOption.getAttribute('data-name') || selectedOption.textContent;
                }
            }
            
            // ç¦ç”¨å¢å‘æŒ‰é’®
            const realMintBtn = document.getElementById('real-mint-btn');
            realMintBtn.disabled = true;
            realMintBtn.textContent = 'ğŸ’ æäº¤ä¸­...';
            
            showRealMintStatus(`æ­£åœ¨åˆ›å»ºæ²»ç†ææ¡ˆï¼šå¢å‘ ${amount} ${denom}...`, 'loading');
            
            try {
                addLog('info', `ğŸ’ æ­£åœ¨åˆ›å»ºæ²»ç†ææ¡ˆï¼šå¢å‘ ${amount} ${denom} åˆ° ${toAccountDisplayName} (${toAccount})`);
                
                const response = await fetch('http://localhost:3001/token/real-mint', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        fromAccount: fromAccount,
                        toAccount: toAccount,
                        amount: amount,
                        denom: denom,
                        title: title || `å¢å‘ ${amount} ${denom}`,
                        description: description || `ææ¡ˆå¢å‘ ${amount} ${denom} ä»£å¸åˆ° ${toAccount}`
                    })
                });
                
                const result = await response.json();
                if (result.success) {
                    addSuccessLog(`ğŸ‰ æ²»ç†ææ¡ˆå·²æäº¤ï¼å¢å‘ ${amount} ${denom} çš„ææ¡ˆå·²åˆ›å»º`);
                    addLog('info', `ğŸ“Š æ³¨æ„ï¼šè¿™æ˜¯çœŸå®çš„æ²»ç†ææ¡ˆï¼Œéœ€è¦ç½‘ç»œæŠ•ç¥¨é€šè¿‡æ‰ä¼šæ‰§è¡Œå¢å‘`);
                    showRealMintStatus(`ğŸ‰ æ²»ç†ææ¡ˆå·²æäº¤ï¼éœ€è¦ç½‘ç»œæŠ•ç¥¨é€šè¿‡`, 'success');
                    
                    // æ¸…ç©ºè¡¨å•
                    document.getElementById('real-mint-to-account').value = '';
                    document.getElementById('real-mint-to-custom').value = '';
                    document.getElementById('real-mint-amount').value = '';
                    document.getElementById('real-mint-title').value = '';
                    document.getElementById('real-mint-description').value = '';
                    
                    // é‡æ–°å¯ç”¨æŒ‰é’®
                    realMintBtn.disabled = false;
                    realMintBtn.textContent = 'ğŸ’ æäº¤å¢å‘ææ¡ˆ';
                    
                    // 5ç§’åå…³é—­è¡¨å•
                    setTimeout(() => {
                        hideRealMintTokenForm();
                    }, 5000);
                } else {
                    addLog('error', `âŒ æ²»ç†ææ¡ˆæäº¤å¤±è´¥: ${result.error}`);
                    showRealMintStatus(`âŒ ææ¡ˆæäº¤å¤±è´¥: ${result.error}`, 'error');
                    // é‡æ–°å¯ç”¨æŒ‰é’®
                    realMintBtn.disabled = false;
                    realMintBtn.textContent = 'ğŸ’ æäº¤å¢å‘ææ¡ˆ';
                }
            } catch (error) {
                addLog('error', `âŒ æ²»ç†ææ¡ˆæäº¤å¤±è´¥: ${error.message}`);
                showRealMintStatus(`âŒ ç½‘ç»œé”™è¯¯: ${error.message}`, 'error');
                // é‡æ–°å¯ç”¨æŒ‰é’®
                realMintBtn.disabled = false;
                realMintBtn.textContent = 'ğŸ’ æäº¤å¢å‘ææ¡ˆ';
            }
        }
        
        // åˆ·æ–°Tokenåˆ†å¸ƒæ•°æ®
        async function refreshTokenDistribution() {
            const tokenType = document.getElementById('distribution-token-type').value;
            const container = document.getElementById('token-distribution-list');
            
            try {
                addLog('info', `ğŸ“Š æ­£åœ¨è·å– ${tokenType} åˆ†å¸ƒæ•°æ®...`);
                container.innerHTML = 'åŠ è½½ä¸­...';
                
                let distributions = [];
                let totalAmount = 0;
                
                // è·å–æ‰€æœ‰é’±åŒ…çš„æŒ‡å®šä»£å¸ä½™é¢
                for (const wallet of allWallets) {
                    try {
                        const balance = await getBalance(wallet.address);
                        const tokenBalance = balance.find(b => b.denom === tokenType);
                        
                        if (tokenBalance && parseInt(tokenBalance.amount) > 0) {
                            const amount = parseInt(tokenBalance.amount);
                            distributions.push({
                                name: wallet.name,
                                address: wallet.address,
                                amount: amount
                            });
                            totalAmount += amount;
                        }
                    } catch (error) {
                        console.error(`è·å–${wallet.name}ä½™é¢å¤±è´¥:`, error);
                    }
                }
                
                // æŒ‰ä½™é¢æ’åº
                distributions.sort((a, b) => b.amount - a.amount);
                
                // ç”Ÿæˆåˆ†å¸ƒè¡¨æ ¼
                if (distributions.length === 0) {
                    container.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">æš‚æ— æŒæœ‰è€…</div>';
                } else {
                    let tableHtml = `
                        <table class="token-distribution-table">
                            <thead>
                                <tr>
                                    <th>æ’å</th>
                                    <th>é’±åŒ…åç§°</th>
                                    <th>åœ°å€</th>
                                    <th>æŒæœ‰é‡</th>
                                    <th>å æ¯”</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    
                    distributions.forEach((dist, index) => {
                        const percentage = totalAmount > 0 ? ((dist.amount / totalAmount) * 100).toFixed(2) : '0';
                        tableHtml += `
                            <tr>
                                <td>${index + 1}</td>
                                <td><strong>${dist.name}</strong></td>
                                <td class="address-cell" title="${dist.address}">${dist.address}</td>
                                <td class="amount-cell">${dist.amount.toLocaleString()} ${tokenType}</td>
                                <td class="percentage-cell">${percentage}%</td>
                            </tr>
                        `;
                    });
                    
                    tableHtml += `
                            </tbody>
                        </table>
                        <div style="margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 6px;">
                            <strong>æ€»è®¡:</strong> ${totalAmount.toLocaleString()} ${tokenType} 
                            <span style="margin-left: 20px;"><strong>æŒæœ‰è€…æ•°é‡:</strong> ${distributions.length}</span>
                        </div>
                    `;
                    
                    container.innerHTML = tableHtml;
                }
                
                addLog('info', `ğŸ“Š ${tokenType} åˆ†å¸ƒç»Ÿè®¡å®Œæˆ - æ€»é‡: ${totalAmount.toLocaleString()}, æŒæœ‰è€…: ${distributions.length}`);
                
            } catch (error) {
                addLog('error', `âŒ è·å–Tokenåˆ†å¸ƒå¤±è´¥: ${error.message}`);
                container.innerHTML = '<div style="color: red; text-align: center; padding: 20px;">åŠ è½½å¤±è´¥</div>';
            }
        }

        // ===========================================
        // é’±åŒ…ç®¡ç†åŠŸèƒ½
        // ===========================================

        // æ˜¾ç¤ºåˆ›å»ºé’±åŒ…è¡¨å•
        function showCreateWallet() {
            hideWalletForms();
            document.getElementById('create-wallet-form').style.display = 'block';
        }

        // æ˜¾ç¤ºå¯¼å…¥é’±åŒ…è¡¨å•
        function showImportWallet() {
            hideWalletForms();
            document.getElementById('import-wallet-form').style.display = 'block';
        }

        // éšè—æ‰€æœ‰é’±åŒ…è¡¨å•
        function hideWalletForms() {
            document.getElementById('create-wallet-form').style.display = 'none';
            document.getElementById('import-wallet-form').style.display = 'none';
        }

        // åˆ›å»ºæ–°é’±åŒ…
        async function createWallet() {
            const name = document.getElementById('new-wallet-name').value.trim();
            if (!name) {
                showStatus('è¯·è¾“å…¥é’±åŒ…åç§°', 'error');
                return;
            }

            try {
                addLog('info', `ğŸ”‘ æ­£åœ¨åˆ›å»ºé’±åŒ…: ${name}`);
                const response = await fetch('http://localhost:3001/wallet/create', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name: name })
                });

                const result = await response.json();
                if (result.success) {
                    addSuccessLog(`ğŸ‰ é’±åŒ… "${name}" åˆ›å»ºæˆåŠŸ!`);
                    
                    // æ˜¾ç¤ºåŠ©è®°è¯
                    if (result.output && result.output.mnemonic) {
                        const mnemonicDiv = document.createElement('div');
                        mnemonicDiv.className = 'mnemonic-display';
                        mnemonicDiv.innerHTML = `
                            <div class="mnemonic-warning">âš ï¸ è¯·å®‰å…¨ä¿å­˜ä»¥ä¸‹åŠ©è®°è¯ï¼Œè¿™æ˜¯æ¢å¤é’±åŒ…çš„å”¯ä¸€æ–¹å¼ï¼</div>
                            <strong>åŠ©è®°è¯:</strong><br>${result.output.mnemonic}
                        `;
                        document.getElementById('create-wallet-form').appendChild(mnemonicDiv);
                    }
                    
                    document.getElementById('new-wallet-name').value = '';
                    setTimeout(() => {
                        hideWalletForms();
                        refreshWalletList();
                    }, 5000);
                } else {
                    addLog('error', `âŒ åˆ›å»ºé’±åŒ…å¤±è´¥: ${result.error}`);
                }
            } catch (error) {
                addLog('error', `âŒ åˆ›å»ºé’±åŒ…å¤±è´¥: ${error.message}`);
            }
        }

        // å¯¼å…¥é’±åŒ…
        async function importWallet() {
            const name = document.getElementById('import-wallet-name').value.trim();
            const mnemonic = document.getElementById('wallet-mnemonic').value.trim();
            
            if (!name || !mnemonic) {
                showStatus('è¯·è¾“å…¥é’±åŒ…åç§°å’ŒåŠ©è®°è¯', 'error');
                return;
            }

            try {
                addLog('info', `ğŸ“¥ æ­£åœ¨å¯¼å…¥é’±åŒ…: ${name}`);
                const response = await fetch('http://localhost:3001/wallet/import', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name: name, mnemonic: mnemonic })
                });

                const result = await response.json();
                if (result.success) {
                    addSuccessLog(`ğŸ‰ é’±åŒ… "${name}" å¯¼å…¥æˆåŠŸ!`);
                    document.getElementById('import-wallet-name').value = '';
                    document.getElementById('wallet-mnemonic').value = '';
                    hideWalletForms();
                    refreshWalletList();
                } else {
                    addLog('error', `âŒ å¯¼å…¥é’±åŒ…å¤±è´¥: ${result.error}`);
                }
            } catch (error) {
                addLog('error', `âŒ å¯¼å…¥é’±åŒ…å¤±è´¥: ${error.message}`);
            }
        }

        // åˆ·æ–°é’±åŒ…åˆ—è¡¨
        async function refreshWalletList() {
            try {
                addLog('info', 'ğŸ”„ åˆ·æ–°é’±åŒ…åˆ—è¡¨...');
                const response = await fetch('http://localhost:3001/wallets/list');
                const result = await response.json();
                
                if (result.success) {
                    allWallets = result.output;
                    displayWallets();
                    updateAccountSelects();
                    addLog('info', `ğŸ“‹ è·å–åˆ° ${allWallets.length} ä¸ªé’±åŒ…`);
                } else {
                    addLog('error', `âŒ è·å–é’±åŒ…åˆ—è¡¨å¤±è´¥: ${result.error}`);
                }
            } catch (error) {
                addLog('error', `âŒ è·å–é’±åŒ…åˆ—è¡¨å¤±è´¥: ${error.message}`);
            }
        }

        // æ˜¾ç¤ºé’±åŒ…åˆ—è¡¨ï¼ˆæ¨ªå‘ç´§å‡‘æ¨¡å¼ï¼‰
        async function displayWallets() {
            const container = document.getElementById('wallets-container');
            
            if (allWallets.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">æš‚æ— é’±åŒ…ï¼Œè¯·åˆ›å»ºæˆ–å¯¼å…¥é’±åŒ…</div>';
                return;
            }

            // å…ˆæ˜¾ç¤ºé’±åŒ…ç®€ä»‹ä¿¡æ¯ï¼Œç„¶åå¼‚æ­¥åŠ è½½ä½™é¢
            let html = '';
            for (const wallet of allWallets) {
                html += `
                    <div class="wallet-item-compact" id="wallet-${wallet.name}">
                        <div class="wallet-compact-name">ğŸ”‘ ${wallet.name}</div>
                        <div class="wallet-compact-balance" id="balance-${wallet.name}">åŠ è½½ä¸­...</div>
                        <div class="wallet-compact-actions-mini">
                            <button class="btn-mini" onclick="sendTokensToWallet('${wallet.address}')" title="å‘é€1000 token">ğŸ’°</button>
                            <button class="btn-mini" onclick="sendStakeToWallet('${wallet.address}')" title="å‘é€1000 stake">ğŸ¥©</button>
                            <button class="btn-mini" onclick="toggleWalletDetails('${wallet.name}')" title="æŸ¥çœ‹è¯¦æƒ…">ğŸ‘ï¸</button>
                        </div>
                        <div class="wallet-details" id="details-${wallet.name}">
                            <div><strong>å®Œæ•´åœ°å€:</strong></div>
                            <div class="wallet-address">${wallet.address}</div>
                            <div style="margin-top: 8px; text-align: center;">
                                <button class="btn btn-small" onclick="sendTokensToWallet('${wallet.address}')">ğŸ’° å‘é€ä»£å¸</button>
                            </div>
                        </div>
                    </div>
                `;
            }
            container.innerHTML = html;
            
            // å¼‚æ­¥åŠ è½½æ¯ä¸ªé’±åŒ…çš„ä½™é¢
            for (const wallet of allWallets) {
                try {
                    const balance = await getBalance(wallet.address);
                    const balanceElement = document.getElementById(`balance-${wallet.name}`);
                    if (balanceElement && balance.length > 0) {
                        const balanceHtml = balance.map(b => 
                            `${parseInt(b.amount).toLocaleString()} ${b.denom}`
                        ).join('<br>');
                        balanceElement.innerHTML = balanceHtml;
                    } else if (balanceElement) {
                        balanceElement.innerHTML = '0';
                    }
                } catch (error) {
                    console.error(`åŠ è½½${wallet.name}ä½™é¢å¤±è´¥:`, error);
                    const balanceElement = document.getElementById(`balance-${wallet.name}`);
                    if (balanceElement) {
                        balanceElement.innerHTML = 'åŠ è½½å¤±è´¥';
                    }
                }
            }
        }

        // åˆ‡æ¢é’±åŒ…è¯¦æƒ…æ˜¾ç¤º
        function toggleWalletDetails(walletName) {
            const detailsElement = document.getElementById(`details-${walletName}`);
            const expandBtn = event.target;
            
            if (detailsElement.classList.contains('expanded')) {
                detailsElement.classList.remove('expanded');
                expandBtn.textContent = 'å±•å¼€è¯¦æƒ…';
            } else {
                // å…³é—­å…¶ä»–å·²å±•å¼€çš„è¯¦æƒ…
                document.querySelectorAll('.wallet-details.expanded').forEach(el => {
                    el.classList.remove('expanded');
                });
                document.querySelectorAll('.expand-btn').forEach(btn => {
                    btn.textContent = 'å±•å¼€è¯¦æƒ…';
                });
                
                // å±•å¼€å½“å‰é’±åŒ…è¯¦æƒ…
                detailsElement.classList.add('expanded');
                expandBtn.textContent = 'æ”¶èµ·è¯¦æƒ…';
            }
        }

        // å‘é€ä»£å¸åˆ°æ–°é’±åŒ…ï¼ˆæ°´é¾™å¤´åŠŸèƒ½ï¼‰
        async function sendTokensToWallet(address) {
            // è·å–è§¦å‘çš„æŒ‰é’®å…ƒç´ ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰
            const clickedButton = event ? event.target : null;
            const originalText = clickedButton ? clickedButton.textContent : '';
            
            try {
                // ç¦ç”¨æŒ‰é’®å¹¶æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                if (clickedButton) {
                    clickedButton.disabled = true;
                    clickedButton.textContent = 'ğŸ’¸';
                    clickedButton.style.opacity = '0.6';
                }
                
                addLog('info', `ğŸ’° å‘ ${address} å‘é€ 1000 token...`);
                const response = await fetch('http://localhost:3001/wallet/send-tokens', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        toAccount: address,
                        amount: '1000',
                        denom: 'token'
                    })
                });

                const result = await response.json();
                if (result.success) {
                    addSuccessLog(`ğŸ‰ æˆåŠŸå‘é€ 1000 token åˆ°é’±åŒ…!`);
                    setTimeout(() => {
                        refreshWalletList();
                        refreshBalances();
                    }, 3000);
                } else {
                    addLog('error', `âŒ å‘é€ token å¤±è´¥: ${result.error}`);
                }
            } catch (error) {
                addLog('error', `âŒ å‘é€ token å¤±è´¥: ${error.message}`);
            } finally {
                // é‡æ–°å¯ç”¨æŒ‰é’®å¹¶æ¢å¤åŸå§‹æ–‡æœ¬
                if (clickedButton) {
                    setTimeout(() => {
                        clickedButton.disabled = false;
                        clickedButton.textContent = originalText;
                        clickedButton.style.opacity = '1';
                    }, 2000);
                }
            }
        }

        // å‘é€ stake åˆ°é’±åŒ…ï¼ˆè´¨æŠ¼ä»£å¸æ°´é¾™å¤´ï¼‰
        async function sendStakeToWallet(address) {
            // è·å–è§¦å‘çš„æŒ‰é’®å…ƒç´ ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰
            const clickedButton = event ? event.target : null;
            const originalText = clickedButton ? clickedButton.textContent : '';
            
            try {
                // ç¦ç”¨æŒ‰é’®å¹¶æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                if (clickedButton) {
                    clickedButton.disabled = true;
                    clickedButton.textContent = 'ğŸ”„';
                    clickedButton.style.opacity = '0.6';
                }
                
                addLog('info', `ğŸ¥© å‘ ${address} å‘é€ 1000 stake...`);
                const response = await fetch('http://localhost:3001/wallet/send-tokens', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        toAccount: address,
                        amount: '1000',
                        denom: 'stake'
                    })
                });

                const result = await response.json();
                if (result.success) {
                    addSuccessLog(`ğŸ‰ æˆåŠŸå‘é€ 1000 stake åˆ°é’±åŒ…!`);
                    addLog('info', `ğŸ“ ç°åœ¨å¯ä»¥ç”¨è¿™äº› stake è¿›è¡Œè´¨æŠ¼æˆ–åˆ›å»ºéªŒè¯è€…`);
                    setTimeout(() => {
                        refreshWalletList();
                        refreshBalances();
                    }, 3000);
                } else {
                    addLog('error', `âŒ å‘é€ stake å¤±è´¥: ${result.error}`);
                }
            } catch (error) {
                addLog('error', `âŒ å‘é€ stake å¤±è´¥: ${error.message}`);
            } finally {
                // é‡æ–°å¯ç”¨æŒ‰é’®å¹¶æ¢å¤åŸå§‹æ–‡æœ¬
                if (clickedButton) {
                    setTimeout(() => {
                        clickedButton.disabled = false;
                        clickedButton.textContent = originalText;
                        clickedButton.style.opacity = '1';
                    }, 2000);
                }
            }
        }

        // ===========================================
        // å¥–åŠ±ç®¡ç†åŠŸèƒ½
        // ===========================================
        
        let allRewards = [];
        
        // åˆ·æ–°å¥–åŠ±ä¿¡æ¯
        async function refreshRewards() {
            try {
                addLog('info', 'ğŸ”„ åˆ·æ–°å¥–åŠ±ä¿¡æ¯...');
                
                allRewards = [];
                let totalAmount = 0;
                
                // è·å–æ‰€æœ‰é’±åŒ…çš„å¥–åŠ±
                for (const wallet of allWallets) {
                    try {
                        const response = await fetch(`http://localhost:1317/cosmos/distribution/v1beta1/delegators/${wallet.address}/rewards`);
                        if (response.ok) {
                            const data = await response.json();
                            if (data.rewards && data.rewards.length > 0) {
                                for (const reward of data.rewards) {
                                    if (reward.reward && reward.reward.length > 0) {
                                        const rewardInfo = {
                                            delegatorAddress: wallet.address,
                                            delegatorName: wallet.name,
                                            validatorAddress: reward.validator_address,
                                            rewards: reward.reward
                                        };
                                        allRewards.push(rewardInfo);
                                        
                                        // è®¡ç®—æ€»å¥–åŠ± (åªè®¡ç®— stake)
                                        for (const r of reward.reward) {
                                            if (r.denom === 'stake') {
                                                totalAmount += parseFloat(r.amount);
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    } catch (error) {
                        console.error(`è·å– ${wallet.name} å¥–åŠ±å¤±è´¥:`, error);
                    }
                }
                
                displayRewards();
                updateTotalRewards(totalAmount);
                addLog('info', `âœ… å¥–åŠ±ä¿¡æ¯å·²æ›´æ–°ï¼Œæ€»è®¡: ${(totalAmount/1000000).toFixed(8)} stake`);
                
            } catch (error) {
                addLog('error', `âŒ åˆ·æ–°å¥–åŠ±å¤±è´¥: ${error.message}`);
            }
        }
        
        // æ˜¾ç¤ºå¥–åŠ±åˆ—è¡¨
        function displayRewards() {
            const container = document.getElementById('rewards-list');
            
            if (allRewards.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">æš‚æ— æœªæå–å¥–åŠ±</div>';
                return;
            }
            
            let html = '';
            for (const rewardInfo of allRewards) {
                // æ‰¾åˆ°å¯¹åº”çš„éªŒè¯è€…åç§°
                const validator = allValidators.find(v => v.operator_address === rewardInfo.validatorAddress);
                const validatorName = validator ? validator.description.moniker : 'æœªçŸ¥éªŒè¯è€…';
                
                // è®¡ç®—å¥–åŠ±é‡‘é¢ - æ˜¾ç¤ºæ›´å¤šå°æ•°ä½
                const stakeReward = rewardInfo.rewards.find(r => r.denom === 'stake');
                const amount = stakeReward ? (parseFloat(stakeReward.amount) / 1000000).toFixed(8) : '0.00000000';
                
                if (parseFloat(amount) > 0.00000001) { // æ˜¾ç¤ºæ›´å°çš„å¥–åŠ±
                    html += `
                        <div class="reward-item">
                            <div class="reward-info">
                                <div class="reward-amount">ğŸ’° ${amount} stake</div>
                                <div class="reward-validator">
                                    å§”æ‰˜è€…: ${rewardInfo.delegatorName} â†’ éªŒè¯è€…: ${validatorName}
                                </div>
                            </div>
                            <div class="reward-actions">
                                <button class="btn-reward" onclick="withdrawSpecificReward('${rewardInfo.delegatorAddress}', '${rewardInfo.validatorAddress}', '${rewardInfo.delegatorName}')">
                                    ğŸ’¸ æå–
                                </button>
                            </div>
                        </div>
                    `;
                }
            }
            
            if (html === '') {
                html = '<div style="text-align: center; padding: 20px; color: #666;">æš‚æ— å¥–åŠ±æˆ–å¥–åŠ±é‡‘é¢æå°</div>';
            }
            
            container.innerHTML = html;
        }
        
        // æ›´æ–°æ€»å¥–åŠ±æ˜¾ç¤º
        function updateTotalRewards(totalAmount) {
            const totalDisplay = document.getElementById('total-reward-amount');
            const withdrawBtn = document.getElementById('withdraw-all-btn');
            
            const totalStake = (totalAmount / 1000000).toFixed(8);
            totalDisplay.textContent = `${totalStake} stake`;
            
            // å¦‚æœæ²¡æœ‰å¥–åŠ±ï¼Œç¦ç”¨æå–æŒ‰é’®
            if (parseFloat(totalStake) < 0.00000001) {
                withdrawBtn.disabled = true;
                withdrawBtn.textContent = 'ğŸ’° æš‚æ— å¥–åŠ±å¯æå–';
            } else {
                withdrawBtn.disabled = false;
                withdrawBtn.textContent = 'ğŸ’° æå–æ‰€æœ‰å¥–åŠ±';
            }
        }
        
        // æå–ç‰¹å®šå¥–åŠ±
        async function withdrawSpecificReward(delegatorAddress, validatorAddress, delegatorName) {
            try {
                addLog('info', `ğŸ† æ­£åœ¨ä¸º ${delegatorName} æå–å¥–åŠ±...`);
                
                const response = await fetch('http://localhost:3001/rewards/withdraw', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        delegatorAddress: delegatorAddress,
                        validatorAddress: validatorAddress,
                        fromAccount: delegatorName
                    })
                });
                
                const result = await response.json();
                if (result.success) {
                    addSuccessLog(`ğŸ‰ ${delegatorName} å¥–åŠ±æå–æˆåŠŸ!`);
                    
                    // ç­‰å¾…å‡ ç§’ååˆ·æ–°
                    setTimeout(() => {
                        refreshRewards();
                        refreshWalletList();
                    }, 3000);
                } else {
                    addLog('error', `âŒ æå–å¥–åŠ±å¤±è´¥: ${result.error}`);
                }
            } catch (error) {
                addLog('error', `âŒ æå–å¥–åŠ±å¤±è´¥: ${error.message}`);
            }
        }
        
        // æå–æ‰€æœ‰å¥–åŠ±
        async function withdrawAllRewards() {
            if (allRewards.length === 0) {
                addLog('warning', 'âš ï¸ æš‚æ— å¥–åŠ±å¯æå–');
                return;
            }
            
            addLog('info', 'ğŸš€ å¼€å§‹æ‰¹é‡æå–æ‰€æœ‰å¥–åŠ±...');
            
            let successCount = 0;
            let totalCount = 0;
            
            for (const rewardInfo of allRewards) {
                const stakeReward = rewardInfo.rewards.find(r => r.denom === 'stake');
                const amount = stakeReward ? parseFloat(stakeReward.amount) : 0;
                
                if (amount > 1000) { // åªæå–æœ‰æ„ä¹‰çš„å¥–åŠ±
                    totalCount++;
                    try {
                        const response = await fetch('http://localhost:3001/rewards/withdraw', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                delegatorAddress: rewardInfo.delegatorAddress,
                                validatorAddress: rewardInfo.validatorAddress,
                                fromAccount: rewardInfo.delegatorName
                            })
                        });
                        
                        const result = await response.json();
                        if (result.success) {
                            successCount++;
                            addLog('info', `âœ… ${rewardInfo.delegatorName} å¥–åŠ±æå–æˆåŠŸ`);
                        } else {
                            addLog('error', `âŒ ${rewardInfo.delegatorName} å¥–åŠ±æå–å¤±è´¥: ${result.error}`);
                        }
                        
                        // é¿å…è¯·æ±‚è¿‡å¿«
                        await new Promise(resolve => setTimeout(resolve, 1000));
                        
                    } catch (error) {
                        addLog('error', `âŒ ${rewardInfo.delegatorName} å¥–åŠ±æå–å¼‚å¸¸: ${error.message}`);
                    }
                }
            }
            
            addSuccessLog(`ğŸŠ æ‰¹é‡æå–å®Œæˆ! æˆåŠŸ: ${successCount}/${totalCount}`);
            
            // ç­‰å¾…ååˆ·æ–°
            setTimeout(() => {
                refreshRewards();
                refreshWalletList();
            }, 3000);
        }

        // ===========================================
        // éªŒè¯è€…ç®¡ç†åŠŸèƒ½
        // ===========================================

        // æ˜¾ç¤ºåˆ›å»ºéªŒè¯è€…è¡¨å•
        function showCreateValidator() {
            hideValidatorForms();
            document.getElementById('create-validator-form').style.display = 'block';
            updateValidatorAccountOptions();
        }

        // æ˜¾ç¤ºå§”æ‰˜è¡¨å•
        function showDelegateForm() {
            hideValidatorForms();
            document.getElementById('delegate-form').style.display = 'block';
            updateValidatorAccountOptions();
            updateValidatorOptions();
        }

        // éšè—æ‰€æœ‰éªŒè¯è€…è¡¨å•
        function hideValidatorForms() {
            document.getElementById('create-validator-form').style.display = 'none';
            document.getElementById('delegate-form').style.display = 'none';
        }

        // åˆ›å»ºéªŒè¯è€…
        async function createValidator() {
            const fromAccount = document.getElementById('validator-account').value;
            const amount = document.getElementById('validator-amount').value;
            const moniker = document.getElementById('validator-moniker').value;
            const commission = document.getElementById('validator-commission').value;

            if (!fromAccount || !amount || !moniker || !commission) {
                showStatus('è¯·å¡«å†™æ‰€æœ‰å­—æ®µ', 'error');
                return;
            }

            try {
                addLog('info', `âš¡ æ­£åœ¨åˆ›å»ºéªŒè¯è€…: ${moniker}`);
                const response = await fetch('http://localhost:3001/validator/create', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        fromAccount: fromAccount,
                        amount: amount,
                        moniker: moniker,
                        commissionRate: (parseFloat(commission) / 100).toString(),
                        maxCommissionRate: '0.20',
                        maxCommissionChangeRate: '0.01'
                    })
                });

                const result = await response.json();
                if (result.success) {
                    addSuccessLog(`ğŸ‰ éªŒè¯è€… "${moniker}" åˆ›å»ºæˆåŠŸ!`);
                    hideValidatorForms();
                    setTimeout(() => {
                        refreshValidatorList();
                        refreshBalances();
                    }, 5000);
                } else {
                    addLog('error', `âŒ åˆ›å»ºéªŒè¯è€…å¤±è´¥: ${result.error}`);
                }
            } catch (error) {
                addLog('error', `âŒ åˆ›å»ºéªŒè¯è€…å¤±è´¥: ${error.message}`);
            }
        }

        // å§”æ‰˜è´¨æŠ¼
        async function delegateStake() {
            const fromAccount = document.getElementById('delegate-account').value;
            const validatorAddress = document.getElementById('delegate-validator').value;
            const amount = document.getElementById('delegate-amount').value;

            if (!fromAccount || !validatorAddress || !amount) {
                showStatus('è¯·å¡«å†™æ‰€æœ‰å­—æ®µ', 'error');
                return;
            }

            try {
                addLog('info', `ğŸ¤ æ­£åœ¨å§”æ‰˜è´¨æŠ¼ ${amount} stake...`);
                const response = await fetch('http://localhost:3001/validator/delegate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        fromAccount: fromAccount,
                        validatorAddress: validatorAddress,
                        amount: amount
                    })
                });

                const result = await response.json();
                if (result.success) {
                    addSuccessLog(`ğŸ‰ å§”æ‰˜è´¨æŠ¼æˆåŠŸ!`);
                    hideValidatorForms();
                    setTimeout(() => {
                        refreshValidatorList();
                        refreshBalances();
                    }, 3000);
                } else {
                    addLog('error', `âŒ å§”æ‰˜è´¨æŠ¼å¤±è´¥: ${result.error}`);
                }
            } catch (error) {
                addLog('error', `âŒ å§”æ‰˜è´¨æŠ¼å¤±è´¥: ${error.message}`);
            }
        }

        // åˆ·æ–°éªŒè¯è€…åˆ—è¡¨
        async function refreshValidatorList() {
            try {
                addLog('info', 'ğŸ”„ åˆ·æ–°éªŒè¯è€…åˆ—è¡¨...');
                const response = await fetch('http://localhost:3001/validators/list');
                const result = await response.json();
                
                if (result.success) {
                    allValidators = result.output.validators;
                    displayValidators();
                    addLog('info', `ğŸ›ï¸ è·å–åˆ° ${allValidators.length} ä¸ªéªŒè¯è€…`);
                } else {
                    addLog('error', `âŒ è·å–éªŒè¯è€…åˆ—è¡¨å¤±è´¥: ${result.error}`);
                }
            } catch (error) {
                addLog('error', `âŒ è·å–éªŒè¯è€…åˆ—è¡¨å¤±è´¥: ${error.message}`);
            }
        }

        // æ˜¾ç¤ºéªŒè¯è€…åˆ—è¡¨
        function displayValidators() {
            const container = document.getElementById('validators-container');
            
            if (allValidators.length === 0) {
                container.innerHTML = '<p>æš‚æ— éªŒè¯è€…</p>';
                return;
            }

            let html = '';
            for (const validator of allValidators) {
                const status = validator.status === 'BOND_STATUS_BONDED' ? 'bonded' : 'unbonded';
                const statusText = validator.status === 'BOND_STATUS_BONDED' ? 'å·²ç»‘å®š' : 'æœªç»‘å®š';
                const tokens = (parseInt(validator.tokens) / 1000000).toFixed(6);

                html += `
                    <div class="validator-item">
                        <h4>âš¡ ${validator.description.moniker}</h4>
                        <div class="validator-address">${validator.operator_address}</div>
                        <div><span class="validator-status ${status}">${statusText}</span></div>
                        <div class="validator-tokens">è´¨æŠ¼: ${tokens} stake</div>
                        <div>ä½£é‡‘ç‡: ${(parseFloat(validator.commission.commission_rates.rate) * 100).toFixed(2)}%</div>
                        <div>æ˜¯å¦ç›‘ç¦: ${validator.jailed ? 'æ˜¯' : 'å¦'}</div>
                    </div>
                `;
            }
            container.innerHTML = html;
        }

        // æ›´æ–°è´¦æˆ·é€‰æ‹©é€‰é¡¹
        function updateAccountSelects() {
            const selects = [
                'from-account', 
                'to-account', 
                'validator-account', 
                'delegate-account'
            ];
            
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    select.innerHTML = '<option value="">é€‰æ‹©è´¦æˆ·</option>';
                    allWallets.forEach(wallet => {
                        select.innerHTML += `<option value="${wallet.name}">${wallet.name} (${wallet.address})</option>`;
                    });
                }
            });
        }

        // æ›´æ–°éªŒè¯è€…é€‰æ‹©é€‰é¡¹
        function updateValidatorOptions() {
            const select = document.getElementById('delegate-validator');
            if (select) {
                select.innerHTML = '<option value="">é€‰æ‹©éªŒè¯è€…</option>';
                allValidators.forEach(validator => {
                    select.innerHTML += `<option value="${validator.operator_address}">${validator.description.moniker}</option>`;
                });
            }
        }

        // æ›´æ–°éªŒè¯è€…è´¦æˆ·é€‰é¡¹
        function updateValidatorAccountOptions() {
            const selects = ['validator-account', 'delegate-account'];
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select && allWallets.length > 0) {
                    select.innerHTML = '<option value="">é€‰æ‹©è´¦æˆ·</option>';
                    allWallets.forEach(wallet => {
                        select.innerHTML += `<option value="${wallet.name}">${wallet.name}</option>`;
                    });
                }
            });
        }

        // ===========================================
        // Tabé¡µé¢åˆ‡æ¢åŠŸèƒ½
        // ===========================================
        
        // Tabåˆ‡æ¢å‡½æ•°
        function switchTab(tabName) {
            // éšè—æ‰€æœ‰tabå†…å®¹
            const allTabPanels = document.querySelectorAll('.tab-panel');
            allTabPanels.forEach(panel => {
                panel.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰tabæŒ‰é’®çš„activeçŠ¶æ€
            const allTabButtons = document.querySelectorAll('.tab-button');
            allTabButtons.forEach(button => {
                button.classList.remove('active');
            });
            
            // æ˜¾ç¤ºå¯¹åº”çš„tabå†…å®¹
            const targetTab = document.getElementById(`tab-${tabName}`);
            if (targetTab) {
                targetTab.classList.add('active');
            }
            
            // æ¿€æ´»å¯¹åº”çš„tabæŒ‰é’®
            const targetButton = document.querySelector(`[onclick="switchTab('${tabName}')"]`);
            if (targetButton) {
                targetButton.classList.add('active');
            }
            
            // è®°å½•å½“å‰æ´»è·ƒçš„tab
            localStorage.setItem('activeTab', tabName);
            
            // æ ¹æ®tabæ‰§è¡Œç‰¹å®šçš„åˆå§‹åŒ–æ“ä½œ
            switch (tabName) {
                case 'blockchain':
                    // åˆ·æ–°æ‰€æœ‰åŒºå—é“¾æ•°æ®
                    refreshAllBlockchainData();
                    break;
                case 'token':
                    // åˆ·æ–°Tokenç»Ÿè®¡
                    refreshTokenStats();
                    break;
                case 'wallet':
                    // åˆ·æ–°é’±åŒ…åˆ—è¡¨å’Œä½™é¢
                    refreshWalletList();
                    refreshBalances();
                    break;
                case 'validator':
                    // åˆ·æ–°éªŒè¯è€…åˆ—è¡¨å’Œå¥–åŠ±
                    refreshValidatorList();
                    refreshRewards();
                    break;
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶æ¢å¤ä¸Šæ¬¡çš„tabçŠ¶æ€
        function initializeTabs() {
            const savedTab = localStorage.getItem('activeTab') || 'blockchain';
            switchTab(savedTab);
        }
        
        // å¤„ç†è¡¨å•å˜åŒ–
        document.getElementById('from-account').addEventListener('change', function() {
            const toSelect = document.getElementById('to-account');
            const fromValue = this.value;
            
            // è‡ªåŠ¨è®¾ç½®ç›®æ ‡è´¦æˆ·ä¸ºå¦ä¸€ä¸ªè´¦æˆ·
            if (allWallets.length >= 2) {
                const otherWallet = allWallets.find(w => w.name !== fromValue);
                if (otherWallet) {
                    toSelect.value = otherWallet.name;
                }
            }
        });
    </script>
</body>
</html>